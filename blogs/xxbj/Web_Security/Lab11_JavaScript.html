<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DVWA - JavaScript | 佩里的实验室</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="--- 加载中 ---">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.40012000.css" as="style"><link rel="preload" href="/assets/js/app.75bcd073.js" as="script"><link rel="preload" href="/assets/js/6.40a18204.js" as="script"><link rel="preload" href="/assets/js/1.dc08dc78.js" as="script"><link rel="preload" href="/assets/js/43.9342f509.js" as="script"><link rel="prefetch" href="/assets/js/10.f35bf08a.js"><link rel="prefetch" href="/assets/js/11.189c2644.js"><link rel="prefetch" href="/assets/js/12.1172d48f.js"><link rel="prefetch" href="/assets/js/13.c2f1dd32.js"><link rel="prefetch" href="/assets/js/14.9396fc08.js"><link rel="prefetch" href="/assets/js/15.5f46b23b.js"><link rel="prefetch" href="/assets/js/16.8503ed01.js"><link rel="prefetch" href="/assets/js/17.a3d7d350.js"><link rel="prefetch" href="/assets/js/18.f6e8706c.js"><link rel="prefetch" href="/assets/js/19.4a44b4e8.js"><link rel="prefetch" href="/assets/js/20.7061fcee.js"><link rel="prefetch" href="/assets/js/21.f3cbeb2a.js"><link rel="prefetch" href="/assets/js/22.fc0ec17f.js"><link rel="prefetch" href="/assets/js/23.a9e0b1a3.js"><link rel="prefetch" href="/assets/js/24.e0c1bff2.js"><link rel="prefetch" href="/assets/js/25.49a6d923.js"><link rel="prefetch" href="/assets/js/26.f07f0953.js"><link rel="prefetch" href="/assets/js/27.dbc0c216.js"><link rel="prefetch" href="/assets/js/28.ae00d9c6.js"><link rel="prefetch" href="/assets/js/29.fbe3e023.js"><link rel="prefetch" href="/assets/js/3.3b677874.js"><link rel="prefetch" href="/assets/js/30.08c01e96.js"><link rel="prefetch" href="/assets/js/31.72b6846b.js"><link rel="prefetch" href="/assets/js/32.918b93e4.js"><link rel="prefetch" href="/assets/js/33.279bbcbb.js"><link rel="prefetch" href="/assets/js/34.7e8ebd2b.js"><link rel="prefetch" href="/assets/js/35.eb84b92e.js"><link rel="prefetch" href="/assets/js/36.6d48fbb2.js"><link rel="prefetch" href="/assets/js/37.f9356651.js"><link rel="prefetch" href="/assets/js/38.2beda4dc.js"><link rel="prefetch" href="/assets/js/39.172f6f2e.js"><link rel="prefetch" href="/assets/js/4.d4b382ff.js"><link rel="prefetch" href="/assets/js/40.249da882.js"><link rel="prefetch" href="/assets/js/41.1983055e.js"><link rel="prefetch" href="/assets/js/42.14e478b4.js"><link rel="prefetch" href="/assets/js/44.c009f361.js"><link rel="prefetch" href="/assets/js/45.5ee7d1dc.js"><link rel="prefetch" href="/assets/js/46.d2bd4440.js"><link rel="prefetch" href="/assets/js/47.5d6b00a1.js"><link rel="prefetch" href="/assets/js/48.c6232051.js"><link rel="prefetch" href="/assets/js/49.b4f0a3f7.js"><link rel="prefetch" href="/assets/js/5.cce8ab33.js"><link rel="prefetch" href="/assets/js/50.8b269602.js"><link rel="prefetch" href="/assets/js/51.d9669675.js"><link rel="prefetch" href="/assets/js/52.14d71933.js"><link rel="prefetch" href="/assets/js/53.17a8fc4e.js"><link rel="prefetch" href="/assets/js/54.d287de8c.js"><link rel="prefetch" href="/assets/js/55.82d0a870.js"><link rel="prefetch" href="/assets/js/56.0b1a3f8f.js"><link rel="prefetch" href="/assets/js/57.fa7ad25c.js"><link rel="prefetch" href="/assets/js/58.838a4e33.js"><link rel="prefetch" href="/assets/js/59.2539490b.js"><link rel="prefetch" href="/assets/js/60.978fe98b.js"><link rel="prefetch" href="/assets/js/61.af0962d7.js"><link rel="prefetch" href="/assets/js/62.8bc12f5e.js"><link rel="prefetch" href="/assets/js/63.21d1db44.js"><link rel="prefetch" href="/assets/js/64.16e01606.js"><link rel="prefetch" href="/assets/js/65.1c8e100d.js"><link rel="prefetch" href="/assets/js/66.a7cf818c.js"><link rel="prefetch" href="/assets/js/67.043b3885.js"><link rel="prefetch" href="/assets/js/68.6c7a2f20.js"><link rel="prefetch" href="/assets/js/69.9c2d4766.js"><link rel="prefetch" href="/assets/js/7.01ca21da.js"><link rel="prefetch" href="/assets/js/70.b41fb06d.js"><link rel="prefetch" href="/assets/js/71.2a11d691.js"><link rel="prefetch" href="/assets/js/72.d46d880d.js"><link rel="prefetch" href="/assets/js/73.b9e0d686.js"><link rel="prefetch" href="/assets/js/74.585983f8.js"><link rel="prefetch" href="/assets/js/75.4e380e18.js"><link rel="prefetch" href="/assets/js/76.4a8efdb0.js"><link rel="prefetch" href="/assets/js/77.1362c1f3.js"><link rel="prefetch" href="/assets/js/78.e468d69d.js"><link rel="prefetch" href="/assets/js/79.a39cc9fa.js"><link rel="prefetch" href="/assets/js/8.2dad43c2.js"><link rel="prefetch" href="/assets/js/80.897c7595.js"><link rel="prefetch" href="/assets/js/9.85ae8f43.js">
    <link rel="stylesheet" href="/assets/css/0.styles.40012000.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1aefc0b4><div data-v-1aefc0b4><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1aefc0b4 data-v-1aefc0b4><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>佩里的实验室</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>--- 加载中 ---</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <span data-v-25ba6db2>2019 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-1aefc0b4><header class="navbar" data-v-1aefc0b4><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="佩里的实验室" class="logo"> <span class="site-name">佩里的实验室</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/技术杂谈/" class="nav-link"><i class="undefined"></i>
  技术杂谈
</a></li><li class="dropdown-item"><!----> <a href="/categories/图文备份/" class="nav-link"><i class="undefined"></i>
  图文备份
</a></li><li class="dropdown-item"><!----> <a href="/categories/未定义的/" class="nav-link"><i class="undefined"></i>
  未定义的
</a></li><li class="dropdown-item"><!----> <a href="/categories/生活小记/" class="nav-link"><i class="undefined"></i>
  生活小记
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习笔记/" class="nav-link"><i class="undefined"></i>
  学习笔记
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/PPPerryPan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1aefc0b4></div> <aside class="sidebar" data-v-1aefc0b4><div class="personal-info-wrapper" data-v-39576ba9 data-v-1aefc0b4><img src="/logo.jpg" alt="author-avatar" class="personal-img" data-v-39576ba9> <!----> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>70</h3> <h6 data-v-39576ba9>文章</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>10</h3> <h6 data-v-39576ba9>标签</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/技术杂谈/" class="nav-link"><i class="undefined"></i>
  技术杂谈
</a></li><li class="dropdown-item"><!----> <a href="/categories/图文备份/" class="nav-link"><i class="undefined"></i>
  图文备份
</a></li><li class="dropdown-item"><!----> <a href="/categories/未定义的/" class="nav-link"><i class="undefined"></i>
  未定义的
</a></li><li class="dropdown-item"><!----> <a href="/categories/生活小记/" class="nav-link"><i class="undefined"></i>
  生活小记
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习笔记/" class="nav-link"><i class="undefined"></i>
  学习笔记
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间线
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/PPPerryPan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-1aefc0b4><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>DVWA - JavaScript</h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <span data-v-25ba6db2>2019 - </span>
          2023
        </a></span></div></div> <div data-v-1aefc0b4><main class="page"><section><div class="page-title"><h1 class="title">DVWA - JavaScript</h1> <div data-v-f875f3fc><!----> <i class="iconfont reco-date" data-v-f875f3fc><span data-v-f875f3fc>2022/8/29</span></i> <!----> <i class="tags iconfont reco-tag" data-v-f875f3fc><span class="tag-item" data-v-f875f3fc>网络安全</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="low"><a href="#low" class="header-anchor">#</a> Low</h2> <h3 id="源代码"><a href="#源代码" class="header-anchor">#</a> 源代码</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'body'</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string heredoc-string"><span class="token delimiter symbol"><span class="token punctuation">&lt;&lt;&lt;</span>EOF</span>
&lt;script&gt;

/*
MD5 code from here
https://github.com/blueimp/JavaScript-MD5
*/

!function(n){&quot;use strict&quot;;function t(n,t){var r=(65535&amp;n)+(65535&amp;t);return(n&gt;&gt;16)+(t&gt;&gt;16)+(r&gt;&gt;16)&lt;&lt;16|65535&amp;r}function r(n,t){return n&lt;&lt;t|n&gt;&gt;&gt;32-t}function e(n,e,o,u,c,f){return t(r(t(t(e,n),t(u,f)),c),o)}function o(n,t,r,o,u,c,f){return e(t&amp;r|~t&amp;o,n,t,u,c,f)}function u(n,t,r,o,u,c,f){return e(t&amp;o|r&amp;~o,n,t,u,c,f)}function c(n,t,r,o,u,c,f){return e(t^r^o,n,t,u,c,f)}function f(n,t,r,o,u,c,f){return e(r^(t|~o),n,t,u,c,f)}function i(n,r){n[r&gt;&gt;5]|=128&lt;&lt;r%32,n[14+(r+64&gt;&gt;&gt;9&lt;&lt;4)]=r;var e,i,a,d,h,l=1732584193,g=-271733879,v=-1732584194,m=271733878;for(e=0;e&lt;n.length;e+=16)i=l,a=g,d=v,h=m,g=f(g=f(g=f(g=f(g=c(g=c(g=c(g=c(g=u(g=u(g=u(g=u(g=o(g=o(g=o(g=o(g,v=o(v,m=o(m,l=o(l,g,v,m,n[e],7,-680876936),g,v,n[e+1],12,-389564586),l,g,n[e+2],17,606105819),m,l,n[e+3],22,-1044525330),v=o(v,m=o(m,l=o(l,g,v,m,n[e+4],7,-176418897),g,v,n[e+5],12,1200080426),l,g,n[e+6],17,-1473231341),m,l,n[e+7],22,-45705983),v=o(v,m=o(m,l=o(l,g,v,m,n[e+8],7,1770035416),g,v,n[e+9],12,-1958414417),l,g,n[e+10],17,-42063),m,l,n[e+11],22,-1990404162),v=o(v,m=o(m,l=o(l,g,v,m,n[e+12],7,1804603682),g,v,n[e+13],12,-40341101),l,g,n[e+14],17,-1502002290),m,l,n[e+15],22,1236535329),v=u(v,m=u(m,l=u(l,g,v,m,n[e+1],5,-165796510),g,v,n[e+6],9,-1069501632),l,g,n[e+11],14,643717713),m,l,n[e],20,-373897302),v=u(v,m=u(m,l=u(l,g,v,m,n[e+5],5,-701558691),g,v,n[e+10],9,38016083),l,g,n[e+15],14,-660478335),m,l,n[e+4],20,-405537848),v=u(v,m=u(m,l=u(l,g,v,m,n[e+9],5,568446438),g,v,n[e+14],9,-1019803690),l,g,n[e+3],14,-187363961),m,l,n[e+8],20,1163531501),v=u(v,m=u(m,l=u(l,g,v,m,n[e+13],5,-1444681467),g,v,n[e+2],9,-51403784),l,g,n[e+7],14,1735328473),m,l,n[e+12],20,-1926607734),v=c(v,m=c(m,l=c(l,g,v,m,n[e+5],4,-378558),g,v,n[e+8],11,-2022574463),l,g,n[e+11],16,1839030562),m,l,n[e+14],23,-35309556),v=c(v,m=c(m,l=c(l,g,v,m,n[e+1],4,-1530992060),g,v,n[e+4],11,1272893353),l,g,n[e+7],16,-155497632),m,l,n[e+10],23,-1094730640),v=c(v,m=c(m,l=c(l,g,v,m,n[e+13],4,681279174),g,v,n[e],11,-358537222),l,g,n[e+3],16,-722521979),m,l,n[e+6],23,76029189),v=c(v,m=c(m,l=c(l,g,v,m,n[e+9],4,-640364487),g,v,n[e+12],11,-421815835),l,g,n[e+15],16,530742520),m,l,n[e+2],23,-995338651),v=f(v,m=f(m,l=f(l,g,v,m,n[e],6,-198630844),g,v,n[e+7],10,1126891415),l,g,n[e+14],15,-1416354905),m,l,n[e+5],21,-57434055),v=f(v,m=f(m,l=f(l,g,v,m,n[e+12],6,1700485571),g,v,n[e+3],10,-1894986606),l,g,n[e+10],15,-1051523),m,l,n[e+1],21,-2054922799),v=f(v,m=f(m,l=f(l,g,v,m,n[e+8],6,1873313359),g,v,n[e+15],10,-30611744),l,g,n[e+6],15,-1560198380),m,l,n[e+13],21,1309151649),v=f(v,m=f(m,l=f(l,g,v,m,n[e+4],6,-145523070),g,v,n[e+11],10,-1120210379),l,g,n[e+2],15,718787259),m,l,n[e+9],21,-343485551),l=t(l,i),g=t(g,a),v=t(v,d),m=t(m,h);return[l,g,v,m]}function a(n){var t,r=&quot;&quot;,e=32*n.length;for(t=0;t&lt;e;t+=8)r+=String.fromCharCode(n[t&gt;&gt;5]&gt;&gt;&gt;t%32&amp;255);return r}function d(n){var t,r=[];for(r[(n.length&gt;&gt;2)-1]=void 0,t=0;t&lt;r.length;t+=1)r[t]=0;var e=8*n.length;for(t=0;t&lt;e;t+=8)r[t&gt;&gt;5]|=(255&amp;n.charCodeAt(t/8))&lt;&lt;t%32;return r}function h(n){return a(i(d(n),8*n.length))}function l(n,t){var r,e,o=d(n),u=[],c=[];for(u[15]=c[15]=void 0,o.length&gt;16&amp;&amp;(o=i(o,8*n.length)),r=0;r&lt;16;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(d(t)),512+8*t.length),a(i(c.concat(e),640))}function g(n){var t,r,e=&quot;&quot;;for(r=0;r&lt;n.length;r+=1)t=n.charCodeAt(r),e+=&quot;0123456789abcdef&quot;.charAt(t&gt;&gt;&gt;4&amp;15)+&quot;0123456789abcdef&quot;.charAt(15&amp;t);return e}function v(n){return unescape(encodeURIComponent(n))}function m(n){return h(v(n))}function p(n){return g(m(n))}function s(n,t){return l(v(n),v(t))}function C(n,t){return g(s(n,t))}function A(n,t,r){return t?r?s(t,n):C(t,n):r?m(n):p(n)}&quot;function&quot;==typeof define&amp;&amp;define.amd?define(function(){return A}):&quot;object&quot;==typeof module&amp;&amp;module.exports?module.exports=A:n.md5=A}(this);

    function rot13(inp) {
        return inp.replace(/[a-zA-Z]/g,function(c){return String.fromCharCode((c&lt;=&quot;Z&quot;?90:122)&gt;=(c=c.charCodeAt(0)+13)?c:c-26);});
    }

    function generate_token() {
        var phrase = document.getElementById(&quot;phrase&quot;).value;
        document.getElementById(&quot;token&quot;).value = md5(rot13(phrase));
    }

    generate_token();
&lt;/script&gt;
<span class="token delimiter symbol">EOF<span class="token punctuation">;</span></span></span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="代码分析"><a href="#代码分析" class="header-anchor">#</a> 代码分析</h3> <p>从 GitHub 上引入了个 <code>md5</code> 运算 JS，在前端生成了一个<code>token</code>。</p> <h3 id="漏洞利用"><a href="#漏洞利用" class="header-anchor">#</a> 漏洞利用</h3> <p>直接输入 success ，提示 token 不对，看一下 F12，猜想是 value 值与 token 值对应</p> <p><img src="/assets/img/image-20220829161459693.534f751c.png" alt="image-20220829161459693"></p> <p>再看看上面的源代码，有一个 <code>generate_token()</code></p> <p>尝试先输入 success， 然后再 <code>generate_token()</code></p> <p>可见 token 更新成功</p> <p><img src="/assets/img/image-20220829161808724.13337f88.png" alt="image-20220829161808724"></p> <p>提交，搞定：</p> <p><img src="data:image/png;base64,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" alt="image-20220829161830273"></p> <h2 id="medium"><a href="#medium" class="header-anchor">#</a> Medium</h2> <h3 id="源代码-2"><a href="#源代码-2" class="header-anchor">#</a> 源代码</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'body'</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">'&lt;script src=&quot;'</span> <span class="token operator">.</span> <span class="token constant">DVWA_WEB_PAGE_TO_ROOT</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'vulnerabilities/javascript/source/medium.js&quot;&gt;&lt;/script&gt;'</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vulnerabilities/javascript/source/medium.js</span>
<span class="token keyword">function</span> <span class="token function">do_something</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> t<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>n<span class="token operator">=</span>e<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>n<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">;</span>n<span class="token operator">--</span><span class="token punctuation">)</span>t<span class="token operator">+=</span>e<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">return</span> t<span class="token punctuation">}</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">do_elsesomething</span><span class="token punctuation">(</span><span class="token string">&quot;XX&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">do_elsesomething</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">=</span><span class="token function">do_something</span><span class="token punctuation">(</span>e<span class="token operator">+</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;phrase&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">+</span><span class="token string">&quot;XX&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="代码分析-2"><a href="#代码分析-2" class="header-anchor">#</a> 代码分析</h3> <p>思路与 Low 等级基本一致，只是生成 token 的函数放到单独的 js 文件里</p> <p>看 <code>medium.js</code>，通过 <code>do_something()</code> 函数来更改 token 值</p> <h3 id="漏洞利用-2"><a href="#漏洞利用-2" class="header-anchor">#</a> 漏洞利用</h3> <p>输入 success 然后 Console 执行 <code>do_elsesomething(&quot;XX&quot;)</code>，然后再提交</p> <p><img src="/assets/img/image-20220829162411121.dbbf50e4.png" alt="image-20220829162411121"></p> <h2 id="high"><a href="#high" class="header-anchor">#</a> High</h2> <h3 id="源代码-3"><a href="#源代码-3" class="header-anchor">#</a> 源代码</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'body'</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">'&lt;script src=&quot;'</span> <span class="token operator">.</span> <span class="token constant">DVWA_WEB_PAGE_TO_ROOT</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'vulnerabilities/javascript/source/high.js&quot;&gt;&lt;/script&gt;'</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// vulnerabilities/javascript/source/high.js</span>
<span class="token keyword">var</span> a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'fromCharCode'</span><span class="token punctuation">,</span><span class="token string">'toString'</span><span class="token punctuation">,</span><span class="token string">'replace'</span><span class="token punctuation">,</span><span class="token string">'BeJ'</span><span class="token punctuation">,</span><span class="token string">'\x5cw+'</span><span class="token punctuation">,</span><span class="token string">'Lyg'</span><span class="token punctuation">,</span><span class="token string">'SuR'</span><span class="token punctuation">,</span><span class="token string">'(w(){\x273M\x203L\x27;q\x201l=\x273K\x203I\x203J\x20T\x27;q\x201R=1c\x202I===\x271n\x27;q\x20Y=1R?2I:{};p(Y.3N){1R=1O}q\x202L=!1R&amp;&amp;1c\x202M===\x271n\x27;q\x202o=!Y.2S&amp;&amp;1c\x202d===\x271n\x27&amp;&amp;2d.2Q&amp;&amp;2d.2Q.3S;p(2o){Y=3R}z\x20p(2L){Y=2M}q\x202G=!Y.3Q&amp;&amp;1c\x202g===\x271n\x27&amp;&amp;2g.X;q\x202s=1c\x202l===\x27w\x27&amp;&amp;2l.3P;q\x201y=!Y.3H&amp;&amp;1c\x20Z!==\x272T\x27;q\x20m=\x273G\x27.3z(\x27\x27);q\x202w=[-3y,3x,3v,3w];q\x20U=[24,16,8,0];q\x20K=[3A,3B,3F,3E,3D,3C,3T,3U,4d,4c,4b,49,4a,4e,4f,4j,4i,4h,3u,48,47,3Z,3Y,3X,3V,3W,40,41,46,45,43,42,4k,3f,38,36,39,37,34,33,2Y,31,2Z,35,3t,3n,3m,3l,3o,3p,3s,3r,3q,3k,3j,3d,3a,3c,3b,3e,3h,3g,3i,4g];q\x201E=[\x271e\x27,\x2727\x27,\x271G\x27,\x272R\x27];q\x20l=[];p(Y.2S||!1z.1K){1z.1K=w(1x){A\x204C.Q.2U.1I(1x)===\x27[1n\x201z]\x27}}p(1y&amp;&amp;(Y.50||!Z.1N)){Z.1N=w(1x){A\x201c\x201x===\x271n\x27&amp;&amp;1x.1w&amp;&amp;1x.1w.1J===Z}}q\x202m=w(1X,x){A\x20w(s){A\x20O\x20N(x,1d).S(s)[1X]()}};q\x202a=w(x){q\x20P=2m(\x271e\x27,x);p(2o){P=2P(P,x)}P.1T=w(){A\x20O\x20N(x)};P.S=w(s){A\x20P.1T().S(s)};1g(q\x20i=0;i&lt;1E.W;++i){q\x20T=1E[i];P[T]=2m(T,x)}A\x20P};q\x202P=w(P,x){q\x201S=2O(\x222N(\x271S\x27)\x22);q\x201Y=2O(\x222N(\x271w\x27).1Y\x22);q\x202n=x?\x271H\x27:\x271q\x27;q\x202z=w(s){p(1c\x20s===\x272p\x27){A\x201S.2x(2n).S(s,\x274S\x27).1G(\x271e\x27)}z{p(s===2q||s===2T){1u\x20O\x201t(1l)}z\x20p(s.1J===Z){s=O\x202r(s)}}p(1z.1K(s)||Z.1N(s)||s.1J===1Y){A\x201S.2x(2n).S(O\x201Y(s)).1G(\x271e\x27)}z{A\x20P(s)}};A\x202z};q\x202k=w(1X,x){A\x20w(G,s){A\x20O\x201P(G,x,1d).S(s)[1X]()}};q\x202f=w(x){q\x20P=2k(\x271e\x27,x);P.1T=w(G){A\x20O\x201P(G,x)};P.S=w(G,s){A\x20P.1T(G).S(s)};1g(q\x20i=0;i&lt;1E.W;++i){q\x20T=1E[i];P[T]=2k(T,x)}A\x20P};w\x20N(x,1v){p(1v){l[0]=l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0;k.l=l}z{k.l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}p(x){k.C=4I;k.B=4H;k.E=4l;k.F=4U;k.J=4J;k.I=4K;k.H=4L;k.D=4T}z{k.C=4X;k.B=4W;k.E=4Y;k.F=4Z;k.J=4V;k.I=4O;k.H=4F;k.D=4s}k.1C=k.1A=k.L=k.2i=0;k.1U=k.1L=1O;k.2j=1d;k.x=x}N.Q.S=w(s){p(k.1U){A}q\x202h,T=1c\x20s;p(T!==\x272p\x27){p(T===\x271n\x27){p(s===2q){1u\x20O\x201t(1l)}z\x20p(1y&amp;&amp;s.1J===Z){s=O\x202r(s)}z\x20p(!1z.1K(s)){p(!1y||!Z.1N(s)){1u\x20O\x201t(1l)}}}z{1u\x20O\x201t(1l)}2h=1d}q\x20r,M=0,i,W=s.W,l=k.l;4t(M&lt;W){p(k.1L){k.1L=1O;l[0]=k.1C;l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0}p(2h){1g(i=k.1A;M&lt;W&amp;&amp;i&lt;1k;++M){l[i&gt;&gt;2]|=s[M]&lt;&lt;U[i++&amp;3]}}z{1g(i=k.1A;M&lt;W&amp;&amp;i&lt;1k;++M){r=s.1Q(M);p(r&lt;R){l[i&gt;&gt;2]|=r&lt;&lt;U[i++&amp;3]}z\x20p(r&lt;2v){l[i&gt;&gt;2]|=(2t|(r&gt;&gt;6))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}z\x20p(r&lt;2A||r&gt;=2E){l[i&gt;&gt;2]|=(2D|(r&gt;&gt;12))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;6)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}z{r=2C+(((r&amp;23)&lt;&lt;10)|(s.1Q(++M)&amp;23));l[i&gt;&gt;2]|=(2X|(r&gt;&gt;18))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;12)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;6)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}}}k.2u=i;k.L+=i-k.1A;p(i&gt;=1k){k.1C=l[16];k.1A=i-1k;k.1W();k.1L=1d}z{k.1A=i}}p(k.L&gt;4r){k.2i+=k.L/2H&lt;&lt;0;k.L=k.L%2H}A\x20k};N.Q.1s=w(){p(k.1U){A}k.1U=1d;q\x20l=k.l,i=k.2u;l[16]=k.1C;l[i&gt;&gt;2]|=2w[i&amp;3];k.1C=l[16];p(i&gt;=4q){p(!k.1L){k.1W()}l[0]=k.1C;l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0}l[14]=k.2i&lt;&lt;3|k.L&gt;&gt;&gt;29;l[15]=k.L&lt;&lt;3;k.1W()};N.Q.1W=w(){q\x20a=k.C,b=k.B,c=k.E,d=k.F,e=k.J,f=k.I,g=k.H,h=k.D,l=k.l,j,1a,1b,1j,v,1f,1h,1B,1Z,1V,1D;1g(j=16;j&lt;1k;++j){v=l[j-15];1a=((v&gt;&gt;&gt;7)|(v&lt;&lt;25))^((v&gt;&gt;&gt;18)|(v&lt;&lt;14))^(v&gt;&gt;&gt;3);v=l[j-2];1b=((v&gt;&gt;&gt;17)|(v&lt;&lt;15))^((v&gt;&gt;&gt;19)|(v&lt;&lt;13))^(v&gt;&gt;&gt;10);l[j]=l[j-16]+1a+l[j-7]+1b&lt;&lt;0}1D=b&amp;c;1g(j=0;j&lt;1k;j+=4){p(k.2j){p(k.x){1B=4m;v=l[0]-4n;h=v-4o&lt;&lt;0;d=v+4p&lt;&lt;0}z{1B=4v;v=l[0]-4w;h=v-4G&lt;&lt;0;d=v+4D&lt;&lt;0}k.2j=1O}z{1a=((a&gt;&gt;&gt;2)|(a&lt;&lt;30))^((a&gt;&gt;&gt;13)|(a&lt;&lt;19))^((a&gt;&gt;&gt;22)|(a&lt;&lt;10));1b=((e&gt;&gt;&gt;6)|(e&lt;&lt;26))^((e&gt;&gt;&gt;11)|(e&lt;&lt;21))^((e&gt;&gt;&gt;25)|(e&lt;&lt;7));1B=a&amp;b;1j=1B^(a&amp;c)^1D;1h=(e&amp;f)^(~e&amp;g);v=h+1b+1h+K[j]+l[j];1f=1a+1j;h=d+v&lt;&lt;0;d=v+1f&lt;&lt;0}1a=((d&gt;&gt;&gt;2)|(d&lt;&lt;30))^((d&gt;&gt;&gt;13)|(d&lt;&lt;19))^((d&gt;&gt;&gt;22)|(d&lt;&lt;10));1b=((h&gt;&gt;&gt;6)|(h&lt;&lt;26))^((h&gt;&gt;&gt;11)|(h&lt;&lt;21))^((h&gt;&gt;&gt;25)|(h&lt;&lt;7));1Z=d&amp;a;1j=1Z^(d&amp;b)^1B;1h=(h&amp;e)^(~h&amp;f);v=g+1b+1h+K[j+1]+l[j+1];1f=1a+1j;g=c+v&lt;&lt;0;c=v+1f&lt;&lt;0;1a=((c&gt;&gt;&gt;2)|(c&lt;&lt;30))^((c&gt;&gt;&gt;13)|(c&lt;&lt;19))^((c&gt;&gt;&gt;22)|(c&lt;&lt;10));1b=((g&gt;&gt;&gt;6)|(g&lt;&lt;26))^((g&gt;&gt;&gt;11)|(g&lt;&lt;21))^((g&gt;&gt;&gt;25)|(g&lt;&lt;7));1V=c&amp;d;1j=1V^(c&amp;a)^1Z;1h=(g&amp;h)^(~g&amp;e);v=f+1b+1h+K[j+2]+l[j+2];1f=1a+1j;f=b+v&lt;&lt;0;b=v+1f&lt;&lt;0;1a=((b&gt;&gt;&gt;2)|(b&lt;&lt;30))^((b&gt;&gt;&gt;13)|(b&lt;&lt;19))^((b&gt;&gt;&gt;22)|(b&lt;&lt;10));1b=((f&gt;&gt;&gt;6)|(f&lt;&lt;26))^((f&gt;&gt;&gt;11)|(f&lt;&lt;21))^((f&gt;&gt;&gt;25)|(f&lt;&lt;7));1D=b&amp;c;1j=1D^(b&amp;d)^1V;1h=(f&amp;g)^(~f&amp;h);v=e+1b+1h+K[j+3]+l[j+3];1f=1a+1j;e=a+v&lt;&lt;0;a=v+1f&lt;&lt;0}k.C=k.C+a&lt;&lt;0;k.B=k.B+b&lt;&lt;0;k.E=k.E+c&lt;&lt;0;k.F=k.F+d&lt;&lt;0;k.J=k.J+e&lt;&lt;0;k.I=k.I+f&lt;&lt;0;k.H=k.H+g&lt;&lt;0;k.D=k.D+h&lt;&lt;0};N.Q.1e=w(){k.1s();q\x20C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q\x201e=m[(C&gt;&gt;28)&amp;o]+m[(C&gt;&gt;24)&amp;o]+m[(C&gt;&gt;20)&amp;o]+m[(C&gt;&gt;16)&amp;o]+m[(C&gt;&gt;12)&amp;o]+m[(C&gt;&gt;8)&amp;o]+m[(C&gt;&gt;4)&amp;o]+m[C&amp;o]+m[(B&gt;&gt;28)&amp;o]+m[(B&gt;&gt;24)&amp;o]+m[(B&gt;&gt;20)&amp;o]+m[(B&gt;&gt;16)&amp;o]+m[(B&gt;&gt;12)&amp;o]+m[(B&gt;&gt;8)&amp;o]+m[(B&gt;&gt;4)&amp;o]+m[B&amp;o]+m[(E&gt;&gt;28)&amp;o]+m[(E&gt;&gt;24)&amp;o]+m[(E&gt;&gt;20)&amp;o]+m[(E&gt;&gt;16)&amp;o]+m[(E&gt;&gt;12)&amp;o]+m[(E&gt;&gt;8)&amp;o]+m[(E&gt;&gt;4)&amp;o]+m[E&amp;o]+m[(F&gt;&gt;28)&amp;o]+m[(F&gt;&gt;24)&amp;o]+m[(F&gt;&gt;20)&amp;o]+m[(F&gt;&gt;16)&amp;o]+m[(F&gt;&gt;12)&amp;o]+m[(F&gt;&gt;8)&amp;o]+m[(F&gt;&gt;4)&amp;o]+m[F&amp;o]+m[(J&gt;&gt;28)&amp;o]+m[(J&gt;&gt;24)&amp;o]+m[(J&gt;&gt;20)&amp;o]+m[(J&gt;&gt;16)&amp;o]+m[(J&gt;&gt;12)&amp;o]+m[(J&gt;&gt;8)&amp;o]+m[(J&gt;&gt;4)&amp;o]+m[J&amp;o]+m[(I&gt;&gt;28)&amp;o]+m[(I&gt;&gt;24)&amp;o]+m[(I&gt;&gt;20)&amp;o]+m[(I&gt;&gt;16)&amp;o]+m[(I&gt;&gt;12)&amp;o]+m[(I&gt;&gt;8)&amp;o]+m[(I&gt;&gt;4)&amp;o]+m[I&amp;o]+m[(H&gt;&gt;28)&amp;o]+m[(H&gt;&gt;24)&amp;o]+m[(H&gt;&gt;20)&amp;o]+m[(H&gt;&gt;16)&amp;o]+m[(H&gt;&gt;12)&amp;o]+m[(H&gt;&gt;8)&amp;o]+m[(H&gt;&gt;4)&amp;o]+m[H&amp;o];p(!k.x){1e+=m[(D&gt;&gt;28)&amp;o]+m[(D&gt;&gt;24)&amp;o]+m[(D&gt;&gt;20)&amp;o]+m[(D&gt;&gt;16)&amp;o]+m[(D&gt;&gt;12)&amp;o]+m[(D&gt;&gt;8)&amp;o]+m[(D&gt;&gt;4)&amp;o]+m[D&amp;o]}A\x201e};N.Q.2U=N.Q.1e;N.Q.1G=w(){k.1s();q\x20C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q\x202b=[(C&gt;&gt;24)&amp;u,(C&gt;&gt;16)&amp;u,(C&gt;&gt;8)&amp;u,C&amp;u,(B&gt;&gt;24)&amp;u,(B&gt;&gt;16)&amp;u,(B&gt;&gt;8)&amp;u,B&amp;u,(E&gt;&gt;24)&amp;u,(E&gt;&gt;16)&amp;u,(E&gt;&gt;8)&amp;u,E&amp;u,(F&gt;&gt;24)&amp;u,(F&gt;&gt;16)&amp;u,(F&gt;&gt;8)&amp;u,F&amp;u,(J&gt;&gt;24)&amp;u,(J&gt;&gt;16)&amp;u,(J&gt;&gt;8)&amp;u,J&amp;u,(I&gt;&gt;24)&amp;u,(I&gt;&gt;16)&amp;u,(I&gt;&gt;8)&amp;u,I&amp;u,(H&gt;&gt;24)&amp;u,(H&gt;&gt;16)&amp;u,(H&gt;&gt;8)&amp;u,H&amp;u];p(!k.x){2b.4A((D&gt;&gt;24)&amp;u,(D&gt;&gt;16)&amp;u,(D&gt;&gt;8)&amp;u,D&amp;u)}A\x202b};N.Q.27=N.Q.1G;N.Q.2R=w(){k.1s();q\x201w=O\x20Z(k.x?28:32);q\x201i=O\x204x(1w);1i.1p(0,k.C);1i.1p(4,k.B);1i.1p(8,k.E);1i.1p(12,k.F);1i.1p(16,k.J);1i.1p(20,k.I);1i.1p(24,k.H);p(!k.x){1i.1p(28,k.D)}A\x201w};w\x201P(G,x,1v){q\x20i,T=1c\x20G;p(T===\x272p\x27){q\x20L=[],W=G.W,M=0,r;1g(i=0;i&lt;W;++i){r=G.1Q(i);p(r&lt;R){L[M++]=r}z\x20p(r&lt;2v){L[M++]=(2t|(r&gt;&gt;6));L[M++]=(R|(r&amp;V))}z\x20p(r&lt;2A||r&gt;=2E){L[M++]=(2D|(r&gt;&gt;12));L[M++]=(R|((r&gt;&gt;6)&amp;V));L[M++]=(R|(r&amp;V))}z{r=2C+(((r&amp;23)&lt;&lt;10)|(G.1Q(++i)&amp;23));L[M++]=(2X|(r&gt;&gt;18));L[M++]=(R|((r&gt;&gt;12)&amp;V));L[M++]=(R|((r&gt;&gt;6)&amp;V));L[M++]=(R|(r&amp;V))}}G=L}z{p(T===\x271n\x27){p(G===2q){1u\x20O\x201t(1l)}z\x20p(1y&amp;&amp;G.1J===Z){G=O\x202r(G)}z\x20p(!1z.1K(G)){p(!1y||!Z.1N(G)){1u\x20O\x201t(1l)}}}z{1u\x20O\x201t(1l)}}p(G.W&gt;1k){G=(O\x20N(x,1d)).S(G).27()}q\x201F=[],2e=[];1g(i=0;i&lt;1k;++i){q\x20b=G[i]||0;1F[i]=4z^b;2e[i]=4y^b}N.1I(k,x,1v);k.S(2e);k.1F=1F;k.2c=1d;k.1v=1v}1P.Q=O\x20N();1P.Q.1s=w(){N.Q.1s.1I(k);p(k.2c){k.2c=1O;q\x202W=k.27();N.1I(k,k.x,k.1v);k.S(k.1F);k.S(2W);N.Q.1s.1I(k)}};q\x20X=2a();X.1q=X;X.1H=2a(1d);X.1q.2V=2f();X.1H.2V=2f(1d);p(2G){2g.X=X}z{Y.1q=X.1q;Y.1H=X.1H;p(2s){2l(w(){A\x20X})}}})();w\x202y(e){1g(q\x20t=\x22\x22,n=e.W-1;n&gt;=0;n--)t+=e[n];A\x20t}w\x202J(t,y=\x224B\x22){1m.1o(\x221M\x22).1r=1q(1m.1o(\x221M\x22).1r+y)}w\x202B(e=\x224E\x22){1m.1o(\x221M\x22).1r=1q(e+1m.1o(\x221M\x22).1r)}w\x202K(a,b){1m.1o(\x221M\x22).1r=2y(1m.1o(\x222F\x22).1r)}1m.1o(\x222F\x22).1r=\x22\x22;4u(w(){2B(\x224M\x22)},4N);1m.1o(\x224P\x22).4Q(\x224R\x22,2J);2K(\x223O\x22,44);'</span><span class="token punctuation">,</span><span class="token string">'||||||||||||||||||||this|blocks|HEX_CHARS||0x0F|if|var|code|message||0xFF|t1|function|is224||else|return|h1|h0|h7|h2|h3|key|h6|h5|h4||bytes|index|Sha256|new|method|prototype|0x80|update|type|SHIFT|0x3f|length|exports|root|ArrayBuffer|||||||||||s0|s1|typeof|true|hex|t2|for|ch|dataView|maj|64|ERROR|document|object|getElementById|setUint32|sha256|value|finalize|Error|throw|sharedMemory|buffer|obj|ARRAY_BUFFER|Array|start|ab|block|bc|OUTPUT_TYPES|oKeyPad|digest|sha224|call|constructor|isArray|hashed|token|isView|false|HmacSha256|charCodeAt|WINDOW|crypto|create|finalized|cd|hash|outputType|Buffer|da||||0x3ff||||array|||createMethod|arr|inner|process|iKeyPad|createHmacMethod|module|notString|hBytes|first|createHmacOutputMethod|define|createOutputMethod|algorithm|NODE_JS|string|null|Uint8Array|AMD|0xc0|lastByteIndex|0x800|EXTRA|createHash|do_something|nodeMethod|0xd800|token_part_2|0x10000|0xe0|0xe000|phrase|COMMON_JS|4294967296|window|token_part_3|token_part_1|WEB_WORKER|self|require|eval|nodeWrap|versions|arrayBuffer|JS_SHA256_NO_NODE_JS|undefined|toString|hmac|innerHash|0xf0|0xa2bfe8a1|0xc24b8b70||0xa81a664b||0x92722c85|0x81c2c92e|0xc76c51a3|0x53380d13|0x766a0abb|0x4d2c6dfc|0x650a7354|0x748f82ee|0x84c87814|0x78a5636f|0x682e6ff3|0x8cc70208|0x2e1b2138|0xa4506ceb|0x90befffa|0xbef9a3f7|0x5b9cca4f|0x4ed8aa4a|0x106aa070|0xf40e3585|0xd6990624|0x19a4c116|0x1e376c08|0x391c0cb3|0x34b0bcb5|0x2748774c|0xd192e819|0x0fc19dc6|32768|128|8388608|2147483648|split|0x428a2f98|0x71374491|0x59f111f1|0x3956c25b|0xe9b5dba5|0xb5c0fbcf|0123456789abcdef|JS_SHA256_NO_ARRAY_BUFFER|is|invalid|input|strict|use|JS_SHA256_NO_WINDOW|ABCD|amd|JS_SHA256_NO_COMMON_JS|global|node|0x923f82a4|0xab1c5ed5|0x983e5152|0xa831c66d|0x76f988da|0x5cb0a9dc|0x4a7484aa|0xb00327c8|0xbf597fc7|0x14292967|0x06ca6351||0xd5a79147|0xc6e00bf3|0x2de92c6f|0x240ca1cc|0x550c7dc3|0x72be5d74|0x243185be|0x12835b01|0xd807aa98|0x80deb1fe|0x9bdc06a7|0xc67178f2|0xefbe4786|0xe49b69c1|0xc19bf174|0x27b70a85|0x3070dd17|300032|1413257819|150054599|24177077|56|4294967295|0x5be0cd19|while|setTimeout|704751109|210244248|DataView|0x36|0x5c|push|ZZ|Object|143694565|YY|0x1f83d9ab|1521486534|0x367cd507|0xc1059ed8|0xffc00b31|0x68581511|0x64f98fa7|XX|300|0x9b05688c|send|addEventListener|click|utf8|0xbefa4fa4|0xf70e5939|0x510e527f|0xbb67ae85|0x6a09e667|0x3c6ef372|0xa54ff53a|JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW'</span><span class="token punctuation">,</span><span class="token string">'split'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c<span class="token punctuation">,</span>d</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> <span class="token function-variable function">e</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">--</span>f<span class="token punctuation">)</span><span class="token punctuation">{</span>c<span class="token punctuation">[</span><span class="token string">'push'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token string">'shift'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token operator">++</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token number">0x1f4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> <span class="token function-variable function">b</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c<span class="token punctuation">,</span>d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>c<span class="token operator">=</span>c<span class="token operator">-</span><span class="token number">0x0</span><span class="token punctuation">;</span><span class="token keyword">var</span> e<span class="token operator">=</span>a<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">return</span> e<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span>e<span class="token punctuation">,</span>f<span class="token punctuation">,</span>g<span class="token punctuation">,</span>h<span class="token punctuation">,</span>i</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function-variable function">h</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span><span class="token punctuation">(</span>j<span class="token operator">&lt;</span>e<span class="token operator">?</span><span class="token string">''</span><span class="token operator">:</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>j<span class="token operator">/</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>j<span class="token operator">=</span>j<span class="token operator">%</span>e<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0x23</span><span class="token operator">?</span>String<span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x0'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">0x1d</span><span class="token punctuation">)</span><span class="token operator">:</span>j<span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x1'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0x24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">''</span><span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x2'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>String<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">while</span><span class="token punctuation">(</span>f<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>i<span class="token punctuation">[</span><span class="token function">h</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span>g<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token operator">||</span><span class="token function">h</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>g<span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">k</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">'wpA'</span><span class="token operator">!==</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x3'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> i<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token keyword">while</span><span class="token punctuation">(</span>f<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>i<span class="token punctuation">[</span><span class="token function">k</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">=</span>g<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token operator">||</span><span class="token function">k</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>g<span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">l</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> i<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function-variable function">k</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>f<span class="token operator">=</span><span class="token number">0x1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function-variable function">h</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>f<span class="token operator">=</span><span class="token number">0x1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>f<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x5'</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x6'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> i<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>d<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x2'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'\x5cb'</span><span class="token operator">+</span><span class="token function">h</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\x5cb'</span><span class="token punctuation">,</span><span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>g<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">return</span> d<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x7'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x137</span><span class="token punctuation">,</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x8'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'0x9'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="代码分析-3"><a href="#代码分析-3" class="header-anchor">#</a> 代码分析</h3> <p>看起来和 Medium 近似，但是这个 JS 不像是给正常人看的，经过了混淆。</p> <p>不过可以还原就是了。。</p> <p>利用：<a href="https://github.com/ben-sb/javascript-deobfuscator" target="_blank" rel="noopener noreferrer">ben-sb/javascript-deobfuscator: General purpose JavaScript deobfuscator (github.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>得到是人看的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;fromCharCode&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;toString&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;replace&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;BeJ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\\w+&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Lyg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;SuR&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;(w(){'3M 3L';q 1l='3K 3I 3J T';q 1R=1c 2I==='1n';q Y=1R?2I:{};p(Y.3N){1R=1O}q 2L=!1R&amp;&amp;1c 2M==='1n';q 2o=!Y.2S&amp;&amp;1c 2d==='1n'&amp;&amp;2d.2Q&amp;&amp;2d.2Q.3S;p(2o){Y=3R}z p(2L){Y=2M}q 2G=!Y.3Q&amp;&amp;1c 2g==='1n'&amp;&amp;2g.X;q 2s=1c 2l==='w'&amp;&amp;2l.3P;q 1y=!Y.3H&amp;&amp;1c Z!=='2T';q m='3G'.3z('');q 2w=[-3y,3x,3v,3w];q U=[24,16,8,0];q K=[3A,3B,3F,3E,3D,3C,3T,3U,4d,4c,4b,49,4a,4e,4f,4j,4i,4h,3u,48,47,3Z,3Y,3X,3V,3W,40,41,46,45,43,42,4k,3f,38,36,39,37,34,33,2Y,31,2Z,35,3t,3n,3m,3l,3o,3p,3s,3r,3q,3k,3j,3d,3a,3c,3b,3e,3h,3g,3i,4g];q 1E=['1e','27','1G','2R'];q l=[];p(Y.2S||!1z.1K){1z.1K=w(1x){A 4C.Q.2U.1I(1x)==='[1n 1z]'}}p(1y&amp;&amp;(Y.50||!Z.1N)){Z.1N=w(1x){A 1c 1x==='1n'&amp;&amp;1x.1w&amp;&amp;1x.1w.1J===Z}}q 2m=w(1X,x){A w(s){A O N(x,1d).S(s)[1X]()}};q 2a=w(x){q P=2m('1e',x);p(2o){P=2P(P,x)}P.1T=w(){A O N(x)};P.S=w(s){A P.1T().S(s)};1g(q i=0;i&lt;1E.W;++i){q T=1E[i];P[T]=2m(T,x)}A P};q 2P=w(P,x){q 1S=2O(\&quot;2N('1S')\&quot;);q 1Y=2O(\&quot;2N('1w').1Y\&quot;);q 2n=x?'1H':'1q';q 2z=w(s){p(1c s==='2p'){A 1S.2x(2n).S(s,'4S').1G('1e')}z{p(s===2q||s===2T){1u O 1t(1l)}z p(s.1J===Z){s=O 2r(s)}}p(1z.1K(s)||Z.1N(s)||s.1J===1Y){A 1S.2x(2n).S(O 1Y(s)).1G('1e')}z{A P(s)}};A 2z};q 2k=w(1X,x){A w(G,s){A O 1P(G,x,1d).S(s)[1X]()}};q 2f=w(x){q P=2k('1e',x);P.1T=w(G){A O 1P(G,x)};P.S=w(G,s){A P.1T(G).S(s)};1g(q i=0;i&lt;1E.W;++i){q T=1E[i];P[T]=2k(T,x)}A P};w N(x,1v){p(1v){l[0]=l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0;k.l=l}z{k.l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}p(x){k.C=4I;k.B=4H;k.E=4l;k.F=4U;k.J=4J;k.I=4K;k.H=4L;k.D=4T}z{k.C=4X;k.B=4W;k.E=4Y;k.F=4Z;k.J=4V;k.I=4O;k.H=4F;k.D=4s}k.1C=k.1A=k.L=k.2i=0;k.1U=k.1L=1O;k.2j=1d;k.x=x}N.Q.S=w(s){p(k.1U){A}q 2h,T=1c s;p(T!=='2p'){p(T==='1n'){p(s===2q){1u O 1t(1l)}z p(1y&amp;&amp;s.1J===Z){s=O 2r(s)}z p(!1z.1K(s)){p(!1y||!Z.1N(s)){1u O 1t(1l)}}}z{1u O 1t(1l)}2h=1d}q r,M=0,i,W=s.W,l=k.l;4t(M&lt;W){p(k.1L){k.1L=1O;l[0]=k.1C;l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0}p(2h){1g(i=k.1A;M&lt;W&amp;&amp;i&lt;1k;++M){l[i&gt;&gt;2]|=s[M]&lt;&lt;U[i++&amp;3]}}z{1g(i=k.1A;M&lt;W&amp;&amp;i&lt;1k;++M){r=s.1Q(M);p(r&lt;R){l[i&gt;&gt;2]|=r&lt;&lt;U[i++&amp;3]}z p(r&lt;2v){l[i&gt;&gt;2]|=(2t|(r&gt;&gt;6))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}z p(r&lt;2A||r&gt;=2E){l[i&gt;&gt;2]|=(2D|(r&gt;&gt;12))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;6)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}z{r=2C+(((r&amp;23)&lt;&lt;10)|(s.1Q(++M)&amp;23));l[i&gt;&gt;2]|=(2X|(r&gt;&gt;18))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;12)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|((r&gt;&gt;6)&amp;V))&lt;&lt;U[i++&amp;3];l[i&gt;&gt;2]|=(R|(r&amp;V))&lt;&lt;U[i++&amp;3]}}}k.2u=i;k.L+=i-k.1A;p(i&gt;=1k){k.1C=l[16];k.1A=i-1k;k.1W();k.1L=1d}z{k.1A=i}}p(k.L&gt;4r){k.2i+=k.L/2H&lt;&lt;0;k.L=k.L%2H}A k};N.Q.1s=w(){p(k.1U){A}k.1U=1d;q l=k.l,i=k.2u;l[16]=k.1C;l[i&gt;&gt;2]|=2w[i&amp;3];k.1C=l[16];p(i&gt;=4q){p(!k.1L){k.1W()}l[0]=k.1C;l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0}l[14]=k.2i&lt;&lt;3|k.L&gt;&gt;&gt;29;l[15]=k.L&lt;&lt;3;k.1W()};N.Q.1W=w(){q a=k.C,b=k.B,c=k.E,d=k.F,e=k.J,f=k.I,g=k.H,h=k.D,l=k.l,j,1a,1b,1j,v,1f,1h,1B,1Z,1V,1D;1g(j=16;j&lt;1k;++j){v=l[j-15];1a=((v&gt;&gt;&gt;7)|(v&lt;&lt;25))^((v&gt;&gt;&gt;18)|(v&lt;&lt;14))^(v&gt;&gt;&gt;3);v=l[j-2];1b=((v&gt;&gt;&gt;17)|(v&lt;&lt;15))^((v&gt;&gt;&gt;19)|(v&lt;&lt;13))^(v&gt;&gt;&gt;10);l[j]=l[j-16]+1a+l[j-7]+1b&lt;&lt;0}1D=b&amp;c;1g(j=0;j&lt;1k;j+=4){p(k.2j){p(k.x){1B=4m;v=l[0]-4n;h=v-4o&lt;&lt;0;d=v+4p&lt;&lt;0}z{1B=4v;v=l[0]-4w;h=v-4G&lt;&lt;0;d=v+4D&lt;&lt;0}k.2j=1O}z{1a=((a&gt;&gt;&gt;2)|(a&lt;&lt;30))^((a&gt;&gt;&gt;13)|(a&lt;&lt;19))^((a&gt;&gt;&gt;22)|(a&lt;&lt;10));1b=((e&gt;&gt;&gt;6)|(e&lt;&lt;26))^((e&gt;&gt;&gt;11)|(e&lt;&lt;21))^((e&gt;&gt;&gt;25)|(e&lt;&lt;7));1B=a&amp;b;1j=1B^(a&amp;c)^1D;1h=(e&amp;f)^(~e&amp;g);v=h+1b+1h+K[j]+l[j];1f=1a+1j;h=d+v&lt;&lt;0;d=v+1f&lt;&lt;0}1a=((d&gt;&gt;&gt;2)|(d&lt;&lt;30))^((d&gt;&gt;&gt;13)|(d&lt;&lt;19))^((d&gt;&gt;&gt;22)|(d&lt;&lt;10));1b=((h&gt;&gt;&gt;6)|(h&lt;&lt;26))^((h&gt;&gt;&gt;11)|(h&lt;&lt;21))^((h&gt;&gt;&gt;25)|(h&lt;&lt;7));1Z=d&amp;a;1j=1Z^(d&amp;b)^1B;1h=(h&amp;e)^(~h&amp;f);v=g+1b+1h+K[j+1]+l[j+1];1f=1a+1j;g=c+v&lt;&lt;0;c=v+1f&lt;&lt;0;1a=((c&gt;&gt;&gt;2)|(c&lt;&lt;30))^((c&gt;&gt;&gt;13)|(c&lt;&lt;19))^((c&gt;&gt;&gt;22)|(c&lt;&lt;10));1b=((g&gt;&gt;&gt;6)|(g&lt;&lt;26))^((g&gt;&gt;&gt;11)|(g&lt;&lt;21))^((g&gt;&gt;&gt;25)|(g&lt;&lt;7));1V=c&amp;d;1j=1V^(c&amp;a)^1Z;1h=(g&amp;h)^(~g&amp;e);v=f+1b+1h+K[j+2]+l[j+2];1f=1a+1j;f=b+v&lt;&lt;0;b=v+1f&lt;&lt;0;1a=((b&gt;&gt;&gt;2)|(b&lt;&lt;30))^((b&gt;&gt;&gt;13)|(b&lt;&lt;19))^((b&gt;&gt;&gt;22)|(b&lt;&lt;10));1b=((f&gt;&gt;&gt;6)|(f&lt;&lt;26))^((f&gt;&gt;&gt;11)|(f&lt;&lt;21))^((f&gt;&gt;&gt;25)|(f&lt;&lt;7));1D=b&amp;c;1j=1D^(b&amp;d)^1V;1h=(f&amp;g)^(~f&amp;h);v=e+1b+1h+K[j+3]+l[j+3];1f=1a+1j;e=a+v&lt;&lt;0;a=v+1f&lt;&lt;0}k.C=k.C+a&lt;&lt;0;k.B=k.B+b&lt;&lt;0;k.E=k.E+c&lt;&lt;0;k.F=k.F+d&lt;&lt;0;k.J=k.J+e&lt;&lt;0;k.I=k.I+f&lt;&lt;0;k.H=k.H+g&lt;&lt;0;k.D=k.D+h&lt;&lt;0};N.Q.1e=w(){k.1s();q C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q 1e=m[(C&gt;&gt;28)&amp;o]+m[(C&gt;&gt;24)&amp;o]+m[(C&gt;&gt;20)&amp;o]+m[(C&gt;&gt;16)&amp;o]+m[(C&gt;&gt;12)&amp;o]+m[(C&gt;&gt;8)&amp;o]+m[(C&gt;&gt;4)&amp;o]+m[C&amp;o]+m[(B&gt;&gt;28)&amp;o]+m[(B&gt;&gt;24)&amp;o]+m[(B&gt;&gt;20)&amp;o]+m[(B&gt;&gt;16)&amp;o]+m[(B&gt;&gt;12)&amp;o]+m[(B&gt;&gt;8)&amp;o]+m[(B&gt;&gt;4)&amp;o]+m[B&amp;o]+m[(E&gt;&gt;28)&amp;o]+m[(E&gt;&gt;24)&amp;o]+m[(E&gt;&gt;20)&amp;o]+m[(E&gt;&gt;16)&amp;o]+m[(E&gt;&gt;12)&amp;o]+m[(E&gt;&gt;8)&amp;o]+m[(E&gt;&gt;4)&amp;o]+m[E&amp;o]+m[(F&gt;&gt;28)&amp;o]+m[(F&gt;&gt;24)&amp;o]+m[(F&gt;&gt;20)&amp;o]+m[(F&gt;&gt;16)&amp;o]+m[(F&gt;&gt;12)&amp;o]+m[(F&gt;&gt;8)&amp;o]+m[(F&gt;&gt;4)&amp;o]+m[F&amp;o]+m[(J&gt;&gt;28)&amp;o]+m[(J&gt;&gt;24)&amp;o]+m[(J&gt;&gt;20)&amp;o]+m[(J&gt;&gt;16)&amp;o]+m[(J&gt;&gt;12)&amp;o]+m[(J&gt;&gt;8)&amp;o]+m[(J&gt;&gt;4)&amp;o]+m[J&amp;o]+m[(I&gt;&gt;28)&amp;o]+m[(I&gt;&gt;24)&amp;o]+m[(I&gt;&gt;20)&amp;o]+m[(I&gt;&gt;16)&amp;o]+m[(I&gt;&gt;12)&amp;o]+m[(I&gt;&gt;8)&amp;o]+m[(I&gt;&gt;4)&amp;o]+m[I&amp;o]+m[(H&gt;&gt;28)&amp;o]+m[(H&gt;&gt;24)&amp;o]+m[(H&gt;&gt;20)&amp;o]+m[(H&gt;&gt;16)&amp;o]+m[(H&gt;&gt;12)&amp;o]+m[(H&gt;&gt;8)&amp;o]+m[(H&gt;&gt;4)&amp;o]+m[H&amp;o];p(!k.x){1e+=m[(D&gt;&gt;28)&amp;o]+m[(D&gt;&gt;24)&amp;o]+m[(D&gt;&gt;20)&amp;o]+m[(D&gt;&gt;16)&amp;o]+m[(D&gt;&gt;12)&amp;o]+m[(D&gt;&gt;8)&amp;o]+m[(D&gt;&gt;4)&amp;o]+m[D&amp;o]}A 1e};N.Q.2U=N.Q.1e;N.Q.1G=w(){k.1s();q C=k.C,B=k.B,E=k.E,F=k.F,J=k.J,I=k.I,H=k.H,D=k.D;q 2b=[(C&gt;&gt;24)&amp;u,(C&gt;&gt;16)&amp;u,(C&gt;&gt;8)&amp;u,C&amp;u,(B&gt;&gt;24)&amp;u,(B&gt;&gt;16)&amp;u,(B&gt;&gt;8)&amp;u,B&amp;u,(E&gt;&gt;24)&amp;u,(E&gt;&gt;16)&amp;u,(E&gt;&gt;8)&amp;u,E&amp;u,(F&gt;&gt;24)&amp;u,(F&gt;&gt;16)&amp;u,(F&gt;&gt;8)&amp;u,F&amp;u,(J&gt;&gt;24)&amp;u,(J&gt;&gt;16)&amp;u,(J&gt;&gt;8)&amp;u,J&amp;u,(I&gt;&gt;24)&amp;u,(I&gt;&gt;16)&amp;u,(I&gt;&gt;8)&amp;u,I&amp;u,(H&gt;&gt;24)&amp;u,(H&gt;&gt;16)&amp;u,(H&gt;&gt;8)&amp;u,H&amp;u];p(!k.x){2b.4A((D&gt;&gt;24)&amp;u,(D&gt;&gt;16)&amp;u,(D&gt;&gt;8)&amp;u,D&amp;u)}A 2b};N.Q.27=N.Q.1G;N.Q.2R=w(){k.1s();q 1w=O Z(k.x?28:32);q 1i=O 4x(1w);1i.1p(0,k.C);1i.1p(4,k.B);1i.1p(8,k.E);1i.1p(12,k.F);1i.1p(16,k.J);1i.1p(20,k.I);1i.1p(24,k.H);p(!k.x){1i.1p(28,k.D)}A 1w};w 1P(G,x,1v){q i,T=1c G;p(T==='2p'){q L=[],W=G.W,M=0,r;1g(i=0;i&lt;W;++i){r=G.1Q(i);p(r&lt;R){L[M++]=r}z p(r&lt;2v){L[M++]=(2t|(r&gt;&gt;6));L[M++]=(R|(r&amp;V))}z p(r&lt;2A||r&gt;=2E){L[M++]=(2D|(r&gt;&gt;12));L[M++]=(R|((r&gt;&gt;6)&amp;V));L[M++]=(R|(r&amp;V))}z{r=2C+(((r&amp;23)&lt;&lt;10)|(G.1Q(++i)&amp;23));L[M++]=(2X|(r&gt;&gt;18));L[M++]=(R|((r&gt;&gt;12)&amp;V));L[M++]=(R|((r&gt;&gt;6)&amp;V));L[M++]=(R|(r&amp;V))}}G=L}z{p(T==='1n'){p(G===2q){1u O 1t(1l)}z p(1y&amp;&amp;G.1J===Z){G=O 2r(G)}z p(!1z.1K(G)){p(!1y||!Z.1N(G)){1u O 1t(1l)}}}z{1u O 1t(1l)}}p(G.W&gt;1k){G=(O N(x,1d)).S(G).27()}q 1F=[],2e=[];1g(i=0;i&lt;1k;++i){q b=G[i]||0;1F[i]=4z^b;2e[i]=4y^b}N.1I(k,x,1v);k.S(2e);k.1F=1F;k.2c=1d;k.1v=1v}1P.Q=O N();1P.Q.1s=w(){N.Q.1s.1I(k);p(k.2c){k.2c=1O;q 2W=k.27();N.1I(k,k.x,k.1v);k.S(k.1F);k.S(2W);N.Q.1s.1I(k)}};q X=2a();X.1q=X;X.1H=2a(1d);X.1q.2V=2f();X.1H.2V=2f(1d);p(2G){2g.X=X}z{Y.1q=X.1q;Y.1H=X.1H;p(2s){2l(w(){A X})}}})();w 2y(e){1g(q t=\&quot;\&quot;,n=e.W-1;n&gt;=0;n--)t+=e[n];A t}w 2J(t,y=\&quot;4B\&quot;){1m.1o(\&quot;1M\&quot;).1r=1q(1m.1o(\&quot;1M\&quot;).1r+y)}w 2B(e=\&quot;4E\&quot;){1m.1o(\&quot;1M\&quot;).1r=1q(e+1m.1o(\&quot;1M\&quot;).1r)}w 2K(a,b){1m.1o(\&quot;1M\&quot;).1r=2y(1m.1o(\&quot;2F\&quot;).1r)}1m.1o(\&quot;2F\&quot;).1r=\&quot;\&quot;;4u(w(){2B(\&quot;4M\&quot;)},4N);1m.1o(\&quot;4P\&quot;).4Q(\&quot;4R\&quot;,2J);2K(\&quot;3O\&quot;,44);&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;||||||||||||||||||||this|blocks|HEX_CHARS||0x0F|if|var|code|message||0xFF|t1|function|is224||else|return|h1|h0|h7|h2|h3|key|h6|h5|h4||bytes|index|Sha256|new|method|prototype|0x80|update|type|SHIFT|0x3f|length|exports|root|ArrayBuffer|||||||||||s0|s1|typeof|true|hex|t2|for|ch|dataView|maj|64|ERROR|document|object|getElementById|setUint32|sha256|value|finalize|Error|throw|sharedMemory|buffer|obj|ARRAY_BUFFER|Array|start|ab|block|bc|OUTPUT_TYPES|oKeyPad|digest|sha224|call|constructor|isArray|hashed|token|isView|false|HmacSha256|charCodeAt|WINDOW|crypto|create|finalized|cd|hash|outputType|Buffer|da||||0x3ff||||array|||createMethod|arr|inner|process|iKeyPad|createHmacMethod|module|notString|hBytes|first|createHmacOutputMethod|define|createOutputMethod|algorithm|NODE_JS|string|null|Uint8Array|AMD|0xc0|lastByteIndex|0x800|EXTRA|createHash|do_something|nodeMethod|0xd800|token_part_2|0x10000|0xe0|0xe000|phrase|COMMON_JS|4294967296|window|token_part_3|token_part_1|WEB_WORKER|self|require|eval|nodeWrap|versions|arrayBuffer|JS_SHA256_NO_NODE_JS|undefined|toString|hmac|innerHash|0xf0|0xa2bfe8a1|0xc24b8b70||0xa81a664b||0x92722c85|0x81c2c92e|0xc76c51a3|0x53380d13|0x766a0abb|0x4d2c6dfc|0x650a7354|0x748f82ee|0x84c87814|0x78a5636f|0x682e6ff3|0x8cc70208|0x2e1b2138|0xa4506ceb|0x90befffa|0xbef9a3f7|0x5b9cca4f|0x4ed8aa4a|0x106aa070|0xf40e3585|0xd6990624|0x19a4c116|0x1e376c08|0x391c0cb3|0x34b0bcb5|0x2748774c|0xd192e819|0x0fc19dc6|32768|128|8388608|2147483648|split|0x428a2f98|0x71374491|0x59f111f1|0x3956c25b|0xe9b5dba5|0xb5c0fbcf|0123456789abcdef|JS_SHA256_NO_ARRAY_BUFFER|is|invalid|input|strict|use|JS_SHA256_NO_WINDOW|ABCD|amd|JS_SHA256_NO_COMMON_JS|global|node|0x923f82a4|0xab1c5ed5|0x983e5152|0xa831c66d|0x76f988da|0x5cb0a9dc|0x4a7484aa|0xb00327c8|0xbf597fc7|0x14292967|0x06ca6351||0xd5a79147|0xc6e00bf3|0x2de92c6f|0x240ca1cc|0x550c7dc3|0x72be5d74|0x243185be|0x12835b01|0xd807aa98|0x80deb1fe|0x9bdc06a7|0xc67178f2|0xefbe4786|0xe49b69c1|0xc19bf174|0x27b70a85|0x3070dd17|300032|1413257819|150054599|24177077|56|4294967295|0x5be0cd19|while|setTimeout|704751109|210244248|DataView|0x36|0x5c|push|ZZ|Object|143694565|YY|0x1f83d9ab|1521486534|0x367cd507|0xc1059ed8|0xffc00b31|0x68581511|0x64f98fa7|XX|300|0x9b05688c|send|addEventListener|click|utf8|0xbefa4fa4|0xf70e5939|0x510e527f|0xbb67ae85|0x6a09e667|0x3c6ef372|0xa54ff53a|JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;split&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token function-variable function">e</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      c<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">e</span><span class="token punctuation">(</span><span class="token operator">++</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">c<span class="token punctuation">,</span> d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  c <span class="token operator">=</span> c <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> e <span class="token operator">=</span> a<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> e<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">eval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> h<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">h</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>j <span class="token operator">&lt;</span> e <span class="token operator">?</span> <span class="token string">&quot;&quot;</span> <span class="token operator">:</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>j <span class="token operator">/</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>j <span class="token operator">=</span> j <span class="token operator">%</span> e<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">35</span> <span class="token operator">?</span> String<span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">29</span><span class="token punctuation">)</span> <span class="token operator">:</span> j<span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&quot;&quot;</span><span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>f<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      i<span class="token punctuation">[</span><span class="token function">h</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> g<span class="token punctuation">[</span>f<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">h</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    g <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">k</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;wpA&quot;</span> <span class="token operator">!==</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> i<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>f<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          i<span class="token punctuation">[</span><span class="token function">k</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> g<span class="token punctuation">[</span>f<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token function">k</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        g <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">l</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> i<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function-variable function">k</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        f <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function-variable function">h</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    f <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>f<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>g<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x5&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x6&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> i<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        d <span class="token operator">=</span> d<span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;\\b&quot;</span> <span class="token operator">+</span> <span class="token function">h</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> d<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x7&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">311</span><span class="token punctuation">,</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">&quot;0x9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><p>嗯，依然看不懂，那再换一个：<a href="http://deobfuscatejavascript.com/#" target="_blank" rel="noopener noreferrer">Deobfuscate Javascript - Deobfuscate malicious Javascripts for quick and easy analysis<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 前面一堆没用的省略掉。。</span>
<span class="token keyword">function</span> <span class="token function">do_something</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> n <span class="token operator">=</span> e<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> n <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> n<span class="token operator">--</span><span class="token punctuation">)</span> t <span class="token operator">+=</span> e<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> t
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">token_part_3</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token string">&quot;ZZ&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">+</span> y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">token_part_2</span><span class="token punctuation">(</span>e <span class="token operator">=</span> <span class="token string">&quot;YY&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">sha256</span><span class="token punctuation">(</span>e <span class="token operator">+</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">token_part_1</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">do_something</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;phrase&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;phrase&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">token_part_2</span><span class="token punctuation">(</span><span class="token string">&quot;XX&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;send&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> token_part_3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">token_part_1</span><span class="token punctuation">(</span><span class="token string">&quot;ABCD&quot;</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>这下能看出点东西了，生成 token 的步骤是：</p> <ul><li>执行<code>token_part_1(&quot;ABCD&quot;, 44)</code></li> <li>执行<code>token_part_2(&quot;XX&quot;)</code>(原本是延迟 300ms执行的那个）</li> <li>点击按钮的时候执行 <code>token_part_3</code></li></ul> <h3 id="漏洞利用-3"><a href="#漏洞利用-3" class="header-anchor">#</a> 漏洞利用</h3> <p>输入 success ，再到 Console 输入<code>token_part_1(&quot;ABCD&quot;, 44)</code> 和 <code>token_part_2(&quot;XX&quot;)</code>，再提交。</p> <p><img src="/assets/img/image-20220829163512527.5687dfb8.png" alt="image-20220829163512527"></p> <h2 id="impossible"><a href="#impossible" class="header-anchor">#</a> Impossible</h2> <blockquote><p>你永远不要相信来自用户的任何东西，也无法阻止他们搞破坏，所以没有 Impossible 等级。</p></blockquote> <p><img src="/assets/img/image-20220829163615309.d619852d.png" alt="image-20220829163615309"></p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2023/1/12 04:11:40</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#low" class="sidebar-link reco-side-low" data-v-cb1513f6>Low</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#源代码" class="sidebar-link reco-side-源代码" data-v-cb1513f6>源代码</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#代码分析" class="sidebar-link reco-side-代码分析" data-v-cb1513f6>代码分析</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#漏洞利用" class="sidebar-link reco-side-漏洞利用" data-v-cb1513f6>漏洞利用</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#medium" class="sidebar-link reco-side-medium" data-v-cb1513f6>Medium</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#源代码-2" class="sidebar-link reco-side-源代码-2" data-v-cb1513f6>源代码</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#代码分析-2" class="sidebar-link reco-side-代码分析-2" data-v-cb1513f6>代码分析</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#漏洞利用-2" class="sidebar-link reco-side-漏洞利用-2" data-v-cb1513f6>漏洞利用</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#high" class="sidebar-link reco-side-high" data-v-cb1513f6>High</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#源代码-3" class="sidebar-link reco-side-源代码-3" data-v-cb1513f6>源代码</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#代码分析-3" class="sidebar-link reco-side-代码分析-3" data-v-cb1513f6>代码分析</a></li><li class="level-3" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#漏洞利用-3" class="sidebar-link reco-side-漏洞利用-3" data-v-cb1513f6>漏洞利用</a></li><li class="level-2" data-v-cb1513f6><a href="/blogs/xxbj/Web_Security/Lab11_JavaScript.html#impossible" class="sidebar-link reco-side-impossible" data-v-cb1513f6>Impossible</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.75bcd073.js" defer></script><script src="/assets/js/6.40a18204.js" defer></script><script src="/assets/js/1.dc08dc78.js" defer></script><script src="/assets/js/43.9342f509.js" defer></script>
  </body>
</html>
